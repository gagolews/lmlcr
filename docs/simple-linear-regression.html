<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Simple Linear Regression | Lightweight Machine Learning Classics with R</title>
  <meta name="description" content="Explore some of the most fundamental algorithms which have stood the test of time and provide the basis for innovative solutions in data-driven AI. Learn how to use the R language for implementing various stages of data processing and modelling activities. Appreciate mathematics as the universal language for formalising data-intense problems and communicating their solutions. The book is for you if you’re yet to be fluent with university-level linear algebra, calculus and probability theory or you’ve forgotten all the maths you’ve ever learned, and are seeking a gentle, yet thorough, introduction to the topic." />
  <meta name="generator" content="pandoc, pandoc-citeproc, knitr, bookdown (custom), GitBook, and many more" />

  <meta property="og:title" content="1 Simple Linear Regression | Lightweight Machine Learning Classics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://lmlcr.gagolewski.com" />
  
  <meta property="og:description" content="Explore some of the most fundamental algorithms which have stood the test of time and provide the basis for innovative solutions in data-driven AI. Learn how to use the R language for implementing various stages of data processing and modelling activities. Appreciate mathematics as the universal language for formalising data-intense problems and communicating their solutions. The book is for you if you’re yet to be fluent with university-level linear algebra, calculus and probability theory or you’ve forgotten all the maths you’ve ever learned, and are seeking a gentle, yet thorough, introduction to the topic." />
  <meta name="github-repo" content="gagolews/lmlcr" />

  <meta name="author" content="Marek Gagolewski" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="multiple-regression.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<style type="text/css">
div.exercise {
    font-style: italic;
    border-left: 2px solid gray;
    padding-left: 1em;
}

details.solution {
    border-left: 2px solid #ff8888;
    padding-left: 1em;
    margin-bottom: 2em;
}

div.remark {
    border-left: 2px solid gray;
    padding-left: 1em;
}

div.definition {
    font-style: italic;
    border-left: 2px solid #550000;
    padding-left: 1em;
}

</style>


<!-- Use KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<!-- /Use KaTeX -->

<style type="text/css">
/* Marek's custom CSS */

@import url("https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic,700italic");
@import url("https://fonts.googleapis.com/css?family=Alegreya+Sans:400,500,600,700,800,900,400italic,500italic,600italic,700italic,800italic,900italic");
@import url("https://fonts.googleapis.com/css?family=Alegreya+Sans+SC:400,600,700,400italic,600italic,700italic");

span.katex {
    font-size: 100%;
}

</style>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style='font-style: italic' ><a href="./">LMLCR</a></li>
<li style='font-size: smaller' ><a href="https://www.gagolewski.com">Marek Gagolewski</a></li>
<li style='font-size: smaller' ><a href="./">DRAFT v0.2.1 2021-05-10 09:49 (f981ede)</a></li>
<li style='font-size: smaller' ><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Licensed under CC BY-NC-ND 4.0</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#machine-learning"><i class="fa fa-check"></i><b>1.1</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#what-is-machine-learning"><i class="fa fa-check"></i><b>1.1.1</b> What is Machine Learning?</a></li>
<li class="chapter" data-level="1.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#main-types-of-machine-learning-problems"><i class="fa fa-check"></i><b>1.1.2</b> Main Types of Machine Learning Problems</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#supervised-learning"><i class="fa fa-check"></i><b>1.2</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#formalism"><i class="fa fa-check"></i><b>1.2.1</b> Formalism</a></li>
<li class="chapter" data-level="1.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#desired-outputs"><i class="fa fa-check"></i><b>1.2.2</b> Desired Outputs</a></li>
<li class="chapter" data-level="1.2.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#types-of-supervised-learning-problems"><i class="fa fa-check"></i><b>1.2.3</b> Types of Supervised Learning Problems</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#simple-regression"><i class="fa fa-check"></i><b>1.3</b> Simple Regression</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#introduction"><i class="fa fa-check"></i><b>1.3.1</b> Introduction</a></li>
<li class="chapter" data-level="1.3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#search-space-and-objective"><i class="fa fa-check"></i><b>1.3.2</b> Search Space and Objective</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>1.4</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#introduction-1"><i class="fa fa-check"></i><b>1.4.1</b> Introduction</a></li>
<li class="chapter" data-level="1.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#solution-in-r"><i class="fa fa-check"></i><b>1.4.2</b> Solution in R</a></li>
<li class="chapter" data-level="1.4.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#analytic-solution"><i class="fa fa-check"></i><b>1.4.3</b> Analytic Solution</a></li>
<li class="chapter" data-level="1.4.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#derivation-of-the-solution"><i class="fa fa-check"></i><b>1.4.4</b> Derivation of the Solution (**)</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercises-in-r"><i class="fa fa-check"></i><b>1.5</b> Exercises in R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-anscombe-quartet"><i class="fa fa-check"></i><b>1.5.1</b> The Anscombe Quartet</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#outro"><i class="fa fa-check"></i><b>1.6</b> Outro</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#remarks"><i class="fa fa-check"></i><b>1.6.1</b> Remarks</a></li>
<li class="chapter" data-level="1.6.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-reading"><i class="fa fa-check"></i><b>1.6.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>2</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="multiple-regression.html"><a href="multiple-regression.html#introduction-2"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="multiple-regression.html"><a href="multiple-regression.html#formalism-1"><i class="fa fa-check"></i><b>2.1.1</b> Formalism</a></li>
<li class="chapter" data-level="2.1.2" data-path="multiple-regression.html"><a href="multiple-regression.html#simple-linear-regression---recap"><i class="fa fa-check"></i><b>2.1.2</b> Simple Linear Regression - Recap</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="multiple-regression.html"><a href="multiple-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>2.2</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="multiple-regression.html"><a href="multiple-regression.html#problem-formulation"><i class="fa fa-check"></i><b>2.2.1</b> Problem Formulation</a></li>
<li class="chapter" data-level="2.2.2" data-path="multiple-regression.html"><a href="multiple-regression.html#fitting-a-linear-model-in-r"><i class="fa fa-check"></i><b>2.2.2</b> Fitting a Linear Model in R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="multiple-regression.html"><a href="multiple-regression.html#finding-the-best-model"><i class="fa fa-check"></i><b>2.3</b> Finding the Best Model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="multiple-regression.html"><a href="multiple-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>2.3.1</b> Model Diagnostics</a></li>
<li class="chapter" data-level="2.3.2" data-path="multiple-regression.html"><a href="multiple-regression.html#variable-selection"><i class="fa fa-check"></i><b>2.3.2</b> Variable Selection</a></li>
<li class="chapter" data-level="2.3.3" data-path="multiple-regression.html"><a href="multiple-regression.html#variable-transformation"><i class="fa fa-check"></i><b>2.3.3</b> Variable Transformation</a></li>
<li class="chapter" data-level="2.3.4" data-path="multiple-regression.html"><a href="multiple-regression.html#predictive-vs.-descriptive-power"><i class="fa fa-check"></i><b>2.3.4</b> Predictive vs. Descriptive Power</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="multiple-regression.html"><a href="multiple-regression.html#exercises-in-r-1"><i class="fa fa-check"></i><b>2.4</b> Exercises in R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="multiple-regression.html"><a href="multiple-regression.html#anscombes-quartet-revisited"><i class="fa fa-check"></i><b>2.4.1</b> Anscombe’s Quartet Revisited</a></li>
<li class="chapter" data-level="2.4.2" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-simple-models-involving-the-gdp-per-capita"><i class="fa fa-check"></i><b>2.4.2</b> Countries of the World – Simple models involving the GDP per capita</a></li>
<li class="chapter" data-level="2.4.3" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-most-correlated-variables"><i class="fa fa-check"></i><b>2.4.3</b> Countries of the World – Most correlated variables (*)</a></li>
<li class="chapter" data-level="2.4.4" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-a-non-linear-model-based-on-the-gdp-per-capita"><i class="fa fa-check"></i><b>2.4.4</b> Countries of the World – A non-linear model based on the GDP per capita</a></li>
<li class="chapter" data-level="2.4.5" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-a-multiple-regression-model-for-the-per-capita-gdp"><i class="fa fa-check"></i><b>2.4.5</b> Countries of the World – A multiple regression model for the per capita GDP</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="multiple-regression.html"><a href="multiple-regression.html#outro-1"><i class="fa fa-check"></i><b>2.5</b> Outro</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="multiple-regression.html"><a href="multiple-regression.html#remarks-1"><i class="fa fa-check"></i><b>2.5.1</b> Remarks</a></li>
<li class="chapter" data-level="2.5.2" data-path="multiple-regression.html"><a href="multiple-regression.html#other-methods-for-regression"><i class="fa fa-check"></i><b>2.5.2</b> Other Methods for Regression</a></li>
<li class="chapter" data-level="2.5.3" data-path="multiple-regression.html"><a href="multiple-regression.html#derivation-of-the-solution-1"><i class="fa fa-check"></i><b>2.5.3</b> Derivation of the Solution (**)</a></li>
<li class="chapter" data-level="2.5.4" data-path="multiple-regression.html"><a href="multiple-regression.html#solution-in-matrix-form"><i class="fa fa-check"></i><b>2.5.4</b> Solution in Matrix Form (***)</a></li>
<li class="chapter" data-level="2.5.5" data-path="multiple-regression.html"><a href="multiple-regression.html#pearsons-r-in-matrix-form"><i class="fa fa-check"></i><b>2.5.5</b> Pearson’s r in Matrix Form (**)</a></li>
<li class="chapter" data-level="2.5.6" data-path="multiple-regression.html"><a href="multiple-regression.html#further-reading-1"><i class="fa fa-check"></i><b>2.5.6</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html"><i class="fa fa-check"></i><b>3</b> Classification with K-Nearest Neighbours</a>
<ul>
<li class="chapter" data-level="3.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#introduction-3"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#classification-task"><i class="fa fa-check"></i><b>3.1.1</b> Classification Task</a></li>
<li class="chapter" data-level="3.1.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#data"><i class="fa fa-check"></i><b>3.1.2</b> Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#training-and-test-sets"><i class="fa fa-check"></i><b>3.1.3</b> Training and Test Sets</a></li>
<li class="chapter" data-level="3.1.4" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#discussed-methods"><i class="fa fa-check"></i><b>3.1.4</b> Discussed Methods</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#k-nearest-neighbour-classifier"><i class="fa fa-check"></i><b>3.2</b> K-nearest Neighbour Classifier</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#introduction-4"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#example-in-r"><i class="fa fa-check"></i><b>3.2.2</b> Example in R</a></li>
<li class="chapter" data-level="3.2.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#feature-engineering"><i class="fa fa-check"></i><b>3.2.3</b> Feature Engineering</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#model-assessment-and-selection"><i class="fa fa-check"></i><b>3.3</b> Model Assessment and Selection</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#performance-metrics"><i class="fa fa-check"></i><b>3.3.1</b> Performance Metrics</a></li>
<li class="chapter" data-level="3.3.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#how-to-choose-k-for-k-nn-classification"><i class="fa fa-check"></i><b>3.3.2</b> How to Choose K for K-NN Classification?</a></li>
<li class="chapter" data-level="3.3.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#training-validation-and-test-sets"><i class="fa fa-check"></i><b>3.3.3</b> Training, Validation and Test sets</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#implementing-a-k-nn-classifier"><i class="fa fa-check"></i><b>3.4</b> Implementing a K-NN Classifier (*)</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#factor-data-type"><i class="fa fa-check"></i><b>3.4.1</b> Factor Data Type</a></li>
<li class="chapter" data-level="3.4.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#main-routine"><i class="fa fa-check"></i><b>3.4.2</b> Main Routine (*)</a></li>
<li class="chapter" data-level="3.4.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#mode"><i class="fa fa-check"></i><b>3.4.3</b> Mode</a></li>
<li class="chapter" data-level="3.4.4" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#nn-search-routines"><i class="fa fa-check"></i><b>3.4.4</b> NN Search Routines (*)</a></li>
<li class="chapter" data-level="3.4.5" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#different-metrics"><i class="fa fa-check"></i><b>3.4.5</b> Different Metrics (*)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#outro-2"><i class="fa fa-check"></i><b>3.5</b> Outro</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#remarks-2"><i class="fa fa-check"></i><b>3.5.1</b> Remarks</a></li>
<li class="chapter" data-level="3.5.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#side-note-k-nn-regression"><i class="fa fa-check"></i><b>3.5.2</b> Side Note: K-NN Regression</a></li>
<li class="chapter" data-level="3.5.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#further-reading-2"><i class="fa fa-check"></i><b>3.5.3</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html"><i class="fa fa-check"></i><b>4</b> Classification with Trees and Linear Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#introduction-5"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#classification-task-1"><i class="fa fa-check"></i><b>4.1.1</b> Classification Task</a></li>
<li class="chapter" data-level="4.1.2" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#data-1"><i class="fa fa-check"></i><b>4.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#decision-trees"><i class="fa fa-check"></i><b>4.2</b> Decision Trees</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#introduction-6"><i class="fa fa-check"></i><b>4.2.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2.2" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#example-in-r-1"><i class="fa fa-check"></i><b>4.2.2</b> Example in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#a-note-on-decision-tree-learning"><i class="fa fa-check"></i><b>4.2.3</b> A Note on Decision Tree Learning</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#binary-logistic-regression"><i class="fa fa-check"></i><b>4.3</b> Binary Logistic Regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#motivation"><i class="fa fa-check"></i><b>4.3.1</b> Motivation</a></li>
<li class="chapter" data-level="4.3.2" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#logistic-model"><i class="fa fa-check"></i><b>4.3.2</b> Logistic Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#example-in-r-2"><i class="fa fa-check"></i><b>4.3.3</b> Example in R</a></li>
<li class="chapter" data-level="4.3.4" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#loss-function-cross-entropy"><i class="fa fa-check"></i><b>4.3.4</b> Loss Function: Cross-entropy</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#exercises-in-r-2"><i class="fa fa-check"></i><b>4.4</b> Exercises in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#edstats-preparing-data"><i class="fa fa-check"></i><b>4.4.1</b> EdStats – Preparing Data</a></li>
<li class="chapter" data-level="4.4.2" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#edstats-where-girls-are-better-at-maths-than-boys"><i class="fa fa-check"></i><b>4.4.2</b> EdStats – Where Girls Are Better at Maths Than Boys?</a></li>
<li class="chapter" data-level="4.4.3" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#edstats-and-world-factbook-joining-forces"><i class="fa fa-check"></i><b>4.4.3</b> EdStats and World Factbook – Joining Forces</a></li>
<li class="chapter" data-level="4.4.4" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#edstats-fitting-of-binary-logistic-regression-models"><i class="fa fa-check"></i><b>4.4.4</b> EdStats – Fitting of Binary Logistic Regression Models</a></li>
<li class="chapter" data-level="4.4.5" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#edstats-variable-selection-in-binary-logistic-regression"><i class="fa fa-check"></i><b>4.4.5</b> EdStats – Variable Selection in Binary Logistic Regression (*)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#outro-3"><i class="fa fa-check"></i><b>4.5</b> Outro</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#remarks-3"><i class="fa fa-check"></i><b>4.5.1</b> Remarks</a></li>
<li class="chapter" data-level="4.5.2" data-path="classification-with-trees-and-linear-models.html"><a href="classification-with-trees-and-linear-models.html#further-reading-3"><i class="fa fa-check"></i><b>4.5.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html"><i class="fa fa-check"></i><b>5</b> Shallow and Deep Neural Networks (*)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#introduction-7"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#binary-logistic-regression-recap"><i class="fa fa-check"></i><b>5.1.1</b> Binary Logistic Regression: Recap</a></li>
<li class="chapter" data-level="5.1.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#data-2"><i class="fa fa-check"></i><b>5.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#a-note-on-data-representation"><i class="fa fa-check"></i><b>5.2.1</b> A Note on Data Representation</a></li>
<li class="chapter" data-level="5.2.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#extending-logistic-regression"><i class="fa fa-check"></i><b>5.2.2</b> Extending Logistic Regression</a></li>
<li class="chapter" data-level="5.2.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#softmax-function"><i class="fa fa-check"></i><b>5.2.3</b> Softmax Function</a></li>
<li class="chapter" data-level="5.2.4" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#one-hot-encoding-and-decoding"><i class="fa fa-check"></i><b>5.2.4</b> One-Hot Encoding and Decoding</a></li>
<li class="chapter" data-level="5.2.5" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#cross-entropy-revisited"><i class="fa fa-check"></i><b>5.2.5</b> Cross-entropy Revisited</a></li>
<li class="chapter" data-level="5.2.6" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#problem-formulation-in-matrix-form"><i class="fa fa-check"></i><b>5.2.6</b> Problem Formulation in Matrix Form (**)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#artificial-neural-networks"><i class="fa fa-check"></i><b>5.3</b> Artificial Neural Networks</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#artificial-neuron"><i class="fa fa-check"></i><b>5.3.1</b> Artificial Neuron</a></li>
<li class="chapter" data-level="5.3.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#logistic-regression-as-a-neural-network"><i class="fa fa-check"></i><b>5.3.2</b> Logistic Regression as a Neural Network</a></li>
<li class="chapter" data-level="5.3.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#example-in-r-3"><i class="fa fa-check"></i><b>5.3.3</b> Example in R</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#deep-neural-networks"><i class="fa fa-check"></i><b>5.4</b> Deep Neural Networks</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#introduction-8"><i class="fa fa-check"></i><b>5.4.1</b> Introduction</a></li>
<li class="chapter" data-level="5.4.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#activation-functions"><i class="fa fa-check"></i><b>5.4.2</b> Activation Functions</a></li>
<li class="chapter" data-level="5.4.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#example-in-r---2-layers"><i class="fa fa-check"></i><b>5.4.3</b> Example in R - 2 Layers</a></li>
<li class="chapter" data-level="5.4.4" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#example-in-r---6-layers"><i class="fa fa-check"></i><b>5.4.4</b> Example in R - 6 Layers</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#preprocessing-of-data"><i class="fa fa-check"></i><b>5.5</b> Preprocessing of Data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#introduction-9"><i class="fa fa-check"></i><b>5.5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.5.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#image-deskewing"><i class="fa fa-check"></i><b>5.5.2</b> Image Deskewing</a></li>
<li class="chapter" data-level="5.5.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#summary-of-all-the-models-considered"><i class="fa fa-check"></i><b>5.5.3</b> Summary of All the Models Considered</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#outro-4"><i class="fa fa-check"></i><b>5.6</b> Outro</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#remarks-4"><i class="fa fa-check"></i><b>5.6.1</b> Remarks</a></li>
<li class="chapter" data-level="5.6.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#beyond-mnist"><i class="fa fa-check"></i><b>5.6.2</b> Beyond MNIST</a></li>
<li class="chapter" data-level="5.6.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#further-reading-4"><i class="fa fa-check"></i><b>5.6.3</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html"><i class="fa fa-check"></i><b>6</b> Continuous Optimisation with Iterative Algorithms (*)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#introduction-10"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#optimisation-problems"><i class="fa fa-check"></i><b>6.1.1</b> Optimisation Problems</a></li>
<li class="chapter" data-level="6.1.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-optimisation-problems-in-machine-learning"><i class="fa fa-check"></i><b>6.1.2</b> Example Optimisation Problems in Machine Learning</a></li>
<li class="chapter" data-level="6.1.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#types-of-minima-and-maxima"><i class="fa fa-check"></i><b>6.1.3</b> Types of Minima and Maxima</a></li>
<li class="chapter" data-level="6.1.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-objective-over-a-2d-domain"><i class="fa fa-check"></i><b>6.1.4</b> Example Objective over a 2D Domain</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#iterative-methods"><i class="fa fa-check"></i><b>6.2</b> Iterative Methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#introduction-11"><i class="fa fa-check"></i><b>6.2.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-in-r-4"><i class="fa fa-check"></i><b>6.2.2</b> Example in R</a></li>
<li class="chapter" data-level="6.2.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#convergence-to-local-optima"><i class="fa fa-check"></i><b>6.2.3</b> Convergence to Local Optima</a></li>
<li class="chapter" data-level="6.2.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#random-restarts"><i class="fa fa-check"></i><b>6.2.4</b> Random Restarts</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#gradient-descent"><i class="fa fa-check"></i><b>6.3</b> Gradient Descent</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#function-gradient"><i class="fa fa-check"></i><b>6.3.1</b> Function Gradient (*)</a></li>
<li class="chapter" data-level="6.3.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#three-facts-on-the-gradient"><i class="fa fa-check"></i><b>6.3.2</b> Three Facts on the Gradient</a></li>
<li class="chapter" data-level="6.3.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#gradient-descent-algorithm-gd"><i class="fa fa-check"></i><b>6.3.3</b> Gradient Descent Algorithm (GD)</a></li>
<li class="chapter" data-level="6.3.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-mnist"><i class="fa fa-check"></i><b>6.3.4</b> Example: MNIST (*)</a></li>
<li class="chapter" data-level="6.3.5" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#stochastic-gradient-descent-sgd"><i class="fa fa-check"></i><b>6.3.5</b> Stochastic Gradient Descent (SGD) (*)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#a-note-on-convex-optimisation"><i class="fa fa-check"></i><b>6.4</b> A Note on Convex Optimisation (*)</a></li>
<li class="chapter" data-level="6.5" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#outro-5"><i class="fa fa-check"></i><b>6.5</b> Outro</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#remarks-5"><i class="fa fa-check"></i><b>6.5.1</b> Remarks</a></li>
<li class="chapter" data-level="6.5.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#further-reading-5"><i class="fa fa-check"></i><b>6.5.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>7</b> Clustering</a>
<ul>
<li class="chapter" data-level="7.1" data-path="clustering.html"><a href="clustering.html#unsupervised-learning"><i class="fa fa-check"></i><b>7.1</b> Unsupervised Learning</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="clustering.html"><a href="clustering.html#introduction-12"><i class="fa fa-check"></i><b>7.1.1</b> Introduction</a></li>
<li class="chapter" data-level="7.1.2" data-path="clustering.html"><a href="clustering.html#main-types-of-unsupervised-learning-problems"><i class="fa fa-check"></i><b>7.1.2</b> Main Types of Unsupervised Learning Problems</a></li>
<li class="chapter" data-level="7.1.3" data-path="clustering.html"><a href="clustering.html#definitions"><i class="fa fa-check"></i><b>7.1.3</b> Definitions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>7.2</b> K-means Clustering</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="clustering.html"><a href="clustering.html#example-in-r-5"><i class="fa fa-check"></i><b>7.2.1</b> Example in R</a></li>
<li class="chapter" data-level="7.2.2" data-path="clustering.html"><a href="clustering.html#problem-statement"><i class="fa fa-check"></i><b>7.2.2</b> Problem Statement</a></li>
<li class="chapter" data-level="7.2.3" data-path="clustering.html"><a href="clustering.html#algorithms-for-the-k-means-problem"><i class="fa fa-check"></i><b>7.2.3</b> Algorithms for the K-means Problem</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="clustering.html"><a href="clustering.html#agglomerative-hierarchical-clustering"><i class="fa fa-check"></i><b>7.3</b> Agglomerative Hierarchical Clustering</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="clustering.html"><a href="clustering.html#introduction-13"><i class="fa fa-check"></i><b>7.3.1</b> Introduction</a></li>
<li class="chapter" data-level="7.3.2" data-path="clustering.html"><a href="clustering.html#example-in-r-6"><i class="fa fa-check"></i><b>7.3.2</b> Example in R</a></li>
<li class="chapter" data-level="7.3.3" data-path="clustering.html"><a href="clustering.html#linkage-functions"><i class="fa fa-check"></i><b>7.3.3</b> Linkage Functions</a></li>
<li class="chapter" data-level="7.3.4" data-path="clustering.html"><a href="clustering.html#cluster-dendrograms"><i class="fa fa-check"></i><b>7.3.4</b> Cluster Dendrograms</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="clustering.html"><a href="clustering.html#exercises-in-r-3"><i class="fa fa-check"></i><b>7.4</b> Exercises in R</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="clustering.html"><a href="clustering.html#clustering-of-the-world-factbook"><i class="fa fa-check"></i><b>7.4.1</b> Clustering of the World Factbook</a></li>
<li class="chapter" data-level="7.4.2" data-path="clustering.html"><a href="clustering.html#unbalance-dataset-k-means-needs-multiple-starts"><i class="fa fa-check"></i><b>7.4.2</b> Unbalance Dataset – K-Means Needs Multiple Starts</a></li>
<li class="chapter" data-level="7.4.3" data-path="clustering.html"><a href="clustering.html#clustering-of-typical-2d-benchmark-datasets"><i class="fa fa-check"></i><b>7.4.3</b> Clustering of Typical 2D Benchmark Datasets</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="clustering.html"><a href="clustering.html#outro-6"><i class="fa fa-check"></i><b>7.5</b> Outro</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="clustering.html"><a href="clustering.html#remarks-6"><i class="fa fa-check"></i><b>7.5.1</b> Remarks</a></li>
<li class="chapter" data-level="7.5.2" data-path="clustering.html"><a href="clustering.html#further-reading-6"><i class="fa fa-check"></i><b>7.5.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html"><i class="fa fa-check"></i><b>8</b> Optimisation with Genetic Algorithms (*)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#introduction-14"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#recap"><i class="fa fa-check"></i><b>8.1.1</b> Recap</a></li>
<li class="chapter" data-level="8.1.2" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#k-means-revisited"><i class="fa fa-check"></i><b>8.1.2</b> K-means Revisited</a></li>
<li class="chapter" data-level="8.1.3" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#optim-vs.-kmeans"><i class="fa fa-check"></i><b>8.1.3</b> optim() vs. kmeans()</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#genetic-algorithms"><i class="fa fa-check"></i><b>8.2</b> Genetic Algorithms</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#introduction-15"><i class="fa fa-check"></i><b>8.2.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2.2" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#overview-of-the-method"><i class="fa fa-check"></i><b>8.2.2</b> Overview of the Method</a></li>
<li class="chapter" data-level="8.2.3" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#example-implementation---ga-for-k-means"><i class="fa fa-check"></i><b>8.2.3</b> Example Implementation - GA for K-means</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#outro-7"><i class="fa fa-check"></i><b>8.3</b> Outro</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#remarks-7"><i class="fa fa-check"></i><b>8.3.1</b> Remarks</a></li>
<li class="chapter" data-level="8.3.2" data-path="optimisation-with-genetic-algorithms.html"><a href="optimisation-with-genetic-algorithms.html#further-reading-7"><i class="fa fa-check"></i><b>8.3.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="recommender-systems.html"><a href="recommender-systems.html"><i class="fa fa-check"></i><b>9</b> Recommender Systems (*)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="recommender-systems.html"><a href="recommender-systems.html#introduction-16"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="recommender-systems.html"><a href="recommender-systems.html#the-netflix-prize"><i class="fa fa-check"></i><b>9.1.1</b> The Netflix Prize</a></li>
<li class="chapter" data-level="9.1.2" data-path="recommender-systems.html"><a href="recommender-systems.html#main-approaches"><i class="fa fa-check"></i><b>9.1.2</b> Main Approaches</a></li>
<li class="chapter" data-level="9.1.3" data-path="recommender-systems.html"><a href="recommender-systems.html#formalism-2"><i class="fa fa-check"></i><b>9.1.3</b> Formalism</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="recommender-systems.html"><a href="recommender-systems.html#collaborative-filtering"><i class="fa fa-check"></i><b>9.2</b> Collaborative Filtering</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="recommender-systems.html"><a href="recommender-systems.html#example"><i class="fa fa-check"></i><b>9.2.1</b> Example</a></li>
<li class="chapter" data-level="9.2.2" data-path="recommender-systems.html"><a href="recommender-systems.html#similarity-measures"><i class="fa fa-check"></i><b>9.2.2</b> Similarity Measures</a></li>
<li class="chapter" data-level="9.2.3" data-path="recommender-systems.html"><a href="recommender-systems.html#user-based-collaborative-filtering"><i class="fa fa-check"></i><b>9.2.3</b> User-Based Collaborative Filtering</a></li>
<li class="chapter" data-level="9.2.4" data-path="recommender-systems.html"><a href="recommender-systems.html#item-based-collaborative-filtering"><i class="fa fa-check"></i><b>9.2.4</b> Item-Based Collaborative Filtering</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="recommender-systems.html"><a href="recommender-systems.html#exercise-the-movielens-dataset"><i class="fa fa-check"></i><b>9.3</b> Exercise: The MovieLens Dataset (*)</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="recommender-systems.html"><a href="recommender-systems.html#dataset"><i class="fa fa-check"></i><b>9.3.1</b> Dataset</a></li>
<li class="chapter" data-level="9.3.2" data-path="recommender-systems.html"><a href="recommender-systems.html#data-cleansing"><i class="fa fa-check"></i><b>9.3.2</b> Data Cleansing</a></li>
<li class="chapter" data-level="9.3.3" data-path="recommender-systems.html"><a href="recommender-systems.html#item-item-similarities"><i class="fa fa-check"></i><b>9.3.3</b> Item-Item Similarities</a></li>
<li class="chapter" data-level="9.3.4" data-path="recommender-systems.html"><a href="recommender-systems.html#example-recommendations"><i class="fa fa-check"></i><b>9.3.4</b> Example Recommendations</a></li>
<li class="chapter" data-level="9.3.5" data-path="recommender-systems.html"><a href="recommender-systems.html#clustering-1"><i class="fa fa-check"></i><b>9.3.5</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="recommender-systems.html"><a href="recommender-systems.html#outro-8"><i class="fa fa-check"></i><b>9.4</b> Outro</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="recommender-systems.html"><a href="recommender-systems.html#remarks-8"><i class="fa fa-check"></i><b>9.4.1</b> Remarks</a></li>
<li class="chapter" data-level="9.4.2" data-path="recommender-systems.html"><a href="recommender-systems.html#further-reading-8"><i class="fa fa-check"></i><b>9.4.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-convention.html"><a href="appendix-convention.html"><i class="fa fa-check"></i><b>A</b> Notation Convention</a></li>
<li class="chapter" data-level="B" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html"><i class="fa fa-check"></i><b>B</b> Setting Up the R Environment</a>
<ul>
<li class="chapter" data-level="B.1" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#installing-r"><i class="fa fa-check"></i><b>B.1</b> Installing R</a></li>
<li class="chapter" data-level="B.2" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#installing-an-ide"><i class="fa fa-check"></i><b>B.2</b> Installing an IDE</a></li>
<li class="chapter" data-level="B.3" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#installing-recommended-packages"><i class="fa fa-check"></i><b>B.3</b> Installing Recommended Packages</a></li>
<li class="chapter" data-level="B.4" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#first-r-script-in-rstudio"><i class="fa fa-check"></i><b>B.4</b> First R Script in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html"><i class="fa fa-check"></i><b>C</b> Vector Algebra in R</a>
<ul>
<li class="chapter" data-level="C.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#motivation-1"><i class="fa fa-check"></i><b>C.1</b> Motivation</a></li>
<li class="chapter" data-level="C.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#numeric-vectors"><i class="fa fa-check"></i><b>C.2</b> Numeric Vectors</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-numeric-vectors"><i class="fa fa-check"></i><b>C.2.1</b> Creating Numeric Vectors</a></li>
<li class="chapter" data-level="C.2.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#vector-scalar-operations"><i class="fa fa-check"></i><b>C.2.2</b> Vector-Scalar Operations</a></li>
<li class="chapter" data-level="C.2.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#vector-vector-operations"><i class="fa fa-check"></i><b>C.2.3</b> Vector-Vector Operations</a></li>
<li class="chapter" data-level="C.2.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#aggregation-functions"><i class="fa fa-check"></i><b>C.2.4</b> Aggregation Functions</a></li>
<li class="chapter" data-level="C.2.5" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#special-functions"><i class="fa fa-check"></i><b>C.2.5</b> Special Functions</a></li>
<li class="chapter" data-level="C.2.6" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#norms-and-distances"><i class="fa fa-check"></i><b>C.2.6</b> Norms and Distances</a></li>
<li class="chapter" data-level="C.2.7" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#dot-product"><i class="fa fa-check"></i><b>C.2.7</b> Dot Product (*)</a></li>
<li class="chapter" data-level="C.2.8" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#missing-and-other-special-values"><i class="fa fa-check"></i><b>C.2.8</b> Missing and Other Special Values</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#logical-vectors"><i class="fa fa-check"></i><b>C.3</b> Logical Vectors</a>
<ul>
<li class="chapter" data-level="C.3.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-logical-vectors"><i class="fa fa-check"></i><b>C.3.1</b> Creating Logical Vectors</a></li>
<li class="chapter" data-level="C.3.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#logical-operations"><i class="fa fa-check"></i><b>C.3.2</b> Logical Operations</a></li>
<li class="chapter" data-level="C.3.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#comparison-operations"><i class="fa fa-check"></i><b>C.3.3</b> Comparison Operations</a></li>
<li class="chapter" data-level="C.3.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#aggregation-functions-1"><i class="fa fa-check"></i><b>C.3.4</b> Aggregation Functions</a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#character-vectors"><i class="fa fa-check"></i><b>C.4</b> Character Vectors</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-character-vectors"><i class="fa fa-check"></i><b>C.4.1</b> Creating Character Vectors</a></li>
<li class="chapter" data-level="C.4.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#concatenating-character-vectors"><i class="fa fa-check"></i><b>C.4.2</b> Concatenating Character Vectors</a></li>
<li class="chapter" data-level="C.4.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#collapsing-character-vectors"><i class="fa fa-check"></i><b>C.4.3</b> Collapsing Character Vectors</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#vector-subsetting"><i class="fa fa-check"></i><b>C.5</b> Vector Subsetting</a>
<ul>
<li class="chapter" data-level="C.5.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-with-positive-indices"><i class="fa fa-check"></i><b>C.5.1</b> Subsetting with Positive Indices</a></li>
<li class="chapter" data-level="C.5.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-with-negative-indices"><i class="fa fa-check"></i><b>C.5.2</b> Subsetting with Negative Indices</a></li>
<li class="chapter" data-level="C.5.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-with-logical-vectors"><i class="fa fa-check"></i><b>C.5.3</b> Subsetting with Logical Vectors</a></li>
<li class="chapter" data-level="C.5.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#replacing-elements"><i class="fa fa-check"></i><b>C.5.4</b> Replacing Elements</a></li>
<li class="chapter" data-level="C.5.5" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#other-functions"><i class="fa fa-check"></i><b>C.5.5</b> Other Functions</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#named-vectors"><i class="fa fa-check"></i><b>C.6</b> Named Vectors</a>
<ul>
<li class="chapter" data-level="C.6.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-named-vectors"><i class="fa fa-check"></i><b>C.6.1</b> Creating Named Vectors</a></li>
<li class="chapter" data-level="C.6.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-named-vectors-with-character-string-indices"><i class="fa fa-check"></i><b>C.6.2</b> Subsetting Named Vectors with Character String Indices</a></li>
</ul></li>
<li class="chapter" data-level="C.7" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#factors"><i class="fa fa-check"></i><b>C.7</b> Factors</a>
<ul>
<li class="chapter" data-level="C.7.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-factors"><i class="fa fa-check"></i><b>C.7.1</b> Creating Factors</a></li>
<li class="chapter" data-level="C.7.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#levels"><i class="fa fa-check"></i><b>C.7.2</b> Levels</a></li>
<li class="chapter" data-level="C.7.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#internal-representation"><i class="fa fa-check"></i><b>C.7.3</b> Internal Representation (*)</a></li>
</ul></li>
<li class="chapter" data-level="C.8" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#lists"><i class="fa fa-check"></i><b>C.8</b> Lists</a>
<ul>
<li class="chapter" data-level="C.8.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-lists"><i class="fa fa-check"></i><b>C.8.1</b> Creating Lists</a></li>
<li class="chapter" data-level="C.8.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#named-lists"><i class="fa fa-check"></i><b>C.8.2</b> Named Lists</a></li>
<li class="chapter" data-level="C.8.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-and-extracting-from-lists"><i class="fa fa-check"></i><b>C.8.3</b> Subsetting and Extracting From Lists</a></li>
<li class="chapter" data-level="C.8.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#common-operations"><i class="fa fa-check"></i><b>C.8.4</b> Common Operations</a></li>
</ul></li>
<li class="chapter" data-level="C.9" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#further-reading-9"><i class="fa fa-check"></i><b>C.9</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html"><i class="fa fa-check"></i><b>D</b> Matrix Algebra in R</a>
<ul>
<li class="chapter" data-level="D.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#creating-matrices"><i class="fa fa-check"></i><b>D.1</b> Creating Matrices</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix"><i class="fa fa-check"></i><b>D.1.1</b> <code>matrix()</code></a></li>
<li class="chapter" data-level="D.1.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#stacking-vectors"><i class="fa fa-check"></i><b>D.1.2</b> Stacking Vectors</a></li>
<li class="chapter" data-level="D.1.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#beyond-numeric-matrices"><i class="fa fa-check"></i><b>D.1.3</b> Beyond Numeric Matrices</a></li>
<li class="chapter" data-level="D.1.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#naming-rows-and-columns"><i class="fa fa-check"></i><b>D.1.4</b> Naming Rows and Columns</a></li>
<li class="chapter" data-level="D.1.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#other-methods"><i class="fa fa-check"></i><b>D.1.5</b> Other Methods</a></li>
<li class="chapter" data-level="D.1.6" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#internal-representation-1"><i class="fa fa-check"></i><b>D.1.6</b> Internal Representation (*)</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#common-operations-1"><i class="fa fa-check"></i><b>D.2</b> Common Operations</a>
<ul>
<li class="chapter" data-level="D.2.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-transpose"><i class="fa fa-check"></i><b>D.2.1</b> Matrix Transpose</a></li>
<li class="chapter" data-level="D.2.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-scalar-operations"><i class="fa fa-check"></i><b>D.2.2</b> Matrix-Scalar Operations</a></li>
<li class="chapter" data-level="D.2.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-matrix-operations"><i class="fa fa-check"></i><b>D.2.3</b> Matrix-Matrix Operations</a></li>
<li class="chapter" data-level="D.2.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-multiplication"><i class="fa fa-check"></i><b>D.2.4</b> Matrix Multiplication (*)</a></li>
<li class="chapter" data-level="D.2.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#aggregation-of-rows-and-columns"><i class="fa fa-check"></i><b>D.2.5</b> Aggregation of Rows and Columns</a></li>
<li class="chapter" data-level="D.2.6" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#vectorised-special-functions"><i class="fa fa-check"></i><b>D.2.6</b> Vectorised Special Functions</a></li>
<li class="chapter" data-level="D.2.7" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-vector-operations"><i class="fa fa-check"></i><b>D.2.7</b> Matrix-Vector Operations</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-subsetting"><i class="fa fa-check"></i><b>D.3</b> Matrix Subsetting</a>
<ul>
<li class="chapter" data-level="D.3.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-individual-elements"><i class="fa fa-check"></i><b>D.3.1</b> Selecting Individual Elements</a></li>
<li class="chapter" data-level="D.3.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-rows-and-columns"><i class="fa fa-check"></i><b>D.3.2</b> Selecting Rows and Columns</a></li>
<li class="chapter" data-level="D.3.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-submatrices"><i class="fa fa-check"></i><b>D.3.3</b> Selecting Submatrices</a></li>
<li class="chapter" data-level="D.3.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-based-on-logical-vectors-and-matrices"><i class="fa fa-check"></i><b>D.3.4</b> Selecting Based on Logical Vectors and Matrices</a></li>
<li class="chapter" data-level="D.3.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-based-on-two-column-matrices"><i class="fa fa-check"></i><b>D.3.5</b> Selecting Based on Two-Column Matrices</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#further-reading-10"><i class="fa fa-check"></i><b>D.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html"><i class="fa fa-check"></i><b>E</b> Data Frame Wrangling in R</a>
<ul>
<li class="chapter" data-level="E.1" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#creating-data-frames"><i class="fa fa-check"></i><b>E.1</b> Creating Data Frames</a></li>
<li class="chapter" data-level="E.2" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#importing-data-frames"><i class="fa fa-check"></i><b>E.2</b> Importing Data Frames</a></li>
<li class="chapter" data-level="E.3" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#data-frame-subsetting"><i class="fa fa-check"></i><b>E.3</b> Data Frame Subsetting</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#each-data-frame-is-a-list"><i class="fa fa-check"></i><b>E.3.1</b> Each Data Frame is a List</a></li>
<li class="chapter" data-level="E.3.2" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#each-data-frame-is-matrix-like"><i class="fa fa-check"></i><b>E.3.2</b> Each Data Frame is Matrix-like</a></li>
</ul></li>
<li class="chapter" data-level="E.4" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#common-operations-2"><i class="fa fa-check"></i><b>E.4</b> Common Operations</a></li>
<li class="chapter" data-level="E.5" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#metaprogramming-and-formulas"><i class="fa fa-check"></i><b>E.5</b> Metaprogramming and Formulas (*)</a></li>
<li class="chapter" data-level="E.6" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#further-reading-11"><i class="fa fa-check"></i><b>E.6</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lightweight Machine Learning Classics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-linear-regression" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Simple Linear Regression</h1>
<blockquote>
<p>This is a slightly older (distributed in the hope that it will be useful)
version of the forthcoming textbook (ETA 2022) preliminarily entitled
<em>Machine Learning in R from Scratch</em> by
<a href="https://www.gagolewski.com">Marek Gagolewski</a>, which is now undergoing
a major revision (when I am not busy with other projects). There will be
not much work on-going in this repository anymore, as its sources have
moved elsewhere; however, if you happen to find any bugs or typos,
please drop me an
<a href="https://github.com/gagolews/lmlcr/blob/master/CODE_OF_CONDUCT.md">email</a>.
I will share a new draft once it’s ripe. Stay tuned.</p>
</blockquote>
<!-- TODO


"Good" data sets are hard to find, most textbooks fool you



move some quality metrics from Ch.2 to Ch.1

what is high correlation? 0.6 is not! time to stop tolerating weak
associations in the social sciences, you can do better, get
more data or don't do what you do... :/

Social sciences is built on  sand

If your data is crap or your models are weak, admit it and give up.




different coefficients of correlation (Spearman, Kendall) → Chapter 2



We need more than just ML:

Mathematical modelling, differential equations, discrete maths

Statistics for small samples but not needed for big data




It's not all in the data, real life processes are not static

Machine learning models are inherently static, they describe today. Tomorrow may be different, especially if people start to trick the system. Think spam detection , spammers will change their behaviour as new detection algorithms arise

People are smarter than your think, they will challenge the system, by choosing a quality metric you change the direction, but can you really predict what other factors gonna be like when we get there?


Examples : covid prediction not taking into account country policies and other things going on

Garmin vo2max estimation and the risk of going mad/overtraining


-->
<!-- TODO


# What is AI?

**Artificial Intelligence** (AI) aims to construct algorithms and devices
to *make decisions that maximise their chance of successfully achieving
their goals*.



We build AI systems to **solve various problems** under
the assumption of **availability of data**.



Crucial features of AI systems include the ability to:

* perceive the environment

    * input data can come from various sources, e.g., physical sensors,
    files, databases, (pseudo)random number generators
    * data can be of different forms, e.g., vectors, matrices
    and other tensors, graphs, audio/video streams, text

* learn from past experience

    * information on how to correctly behave (what is expected of the system)
    in certain situations might be available
    * sometimes feedback can be given after making a decision ("that was nice!
    well done! look at you go!")
    * some systems can adapt based on current experience as well
    (learn to modify its behaviour *on-line*)

* make decisions, predictions, explanations

    * outputs can be interpreted by a human being and used (critically) for whatever  purpose
    (e.g., a GP for diagnosing illnesses)
    * outputs can be provided to other algorithms to take immediate actions
    (e.g., buy those market shares immediately!)



# Common Applications


Application domains of AI include, but are not limited to:


* Life science and medical data analysis
* Financial services (banking, insurance, investment funds)
* Oil and gas and other energy (solar, mining)
* Real estate
* Pharmaceuticals
* Scientific simulations
* Genomics
* Advertising
* Transportation
* Retail
* Healthcare
* Food production

> Discussion (exercise):
Think of different ways in which
these sectors could benefit from AI solutions.

Basically, wherever we have data and there is a need to improve
things, there is a place for AI solutions.

In the course of this book,
we're going to take a deep dive into what AI really is, what
are its limitations but also how we can use it for improving different processes.

 *AI is a tool*.
Yes, AI is really useful, but it's not a remedy for all our problems.


Behind every success story related to  AI, there are always people involved. Sometimes large
teams of:

* those who deal with hardware, data storage, high performance computing
* those who wrangle data, fit models to data and develop prototypes
* those who are responsible for making the algorithms
work well in production environments
* those who are responsible for providing you
with software/algorithms/models that enable everyone to perform the above,
e.g., languages such as R and Python, libraries, packages

You can call them data engineers, data analysts, machine learning engineers,
data scientists, whatever.

We would like to appreciate the role of open source software.
Most started as non-for-profit and it's beautiful that some of them
continue this way.
Not everything is for sale. Not everything has its price.
Let's not forget it.

We can do a lot of great work for greater good,
with the increased availability of open data,
everyone can be a reporter, an engaged citizen that seeks for truth.
There are NGOs.
Finally, there are researchers (remember that in many countries
still the university's main role is to spread knowledge and not make money!)
that need these methods to make new discoveries, e.g., in psychology,
sociology, agriculture, engineering, biotechnology, pharmacy, medicine, you name it.
-->
<div id="machine-learning" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Machine Learning</h2>
<div id="what-is-machine-learning" class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> What is Machine Learning?</h3>
<p>An <strong>algorithm</strong> is a well-defined sequence of instructions that,
for a given sequence of input arguments,
yields some desired output.</p>
<p>In other words, it is a specific recipe for a <strong>function</strong>.</p>
<p>Developing algorithms is a tedious task.</p>
<p>In <strong>machine learning</strong>, we build and study computer algorithms
that make <em>predictions</em> or <em>decisions</em> but which are not
manually programmed.</p>
<p><strong>Learning</strong> needs some material based upon which new knowledge is to be acquired.</p>
<p>In other words, we need <strong>data</strong>.</p>
</div>
<div id="main-types-of-machine-learning-problems" class="section level3" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Main Types of Machine Learning Problems</h3>
<p>Machine Learning Problems include, but are not limited to:</p>
<ul>
<li><p><strong>Supervised learning</strong> – for every input point (e.g., a photo)
there is an associated desired output (e.g., whether it depicts a crosswalk
or how many cars can be seen on it)</p></li>
<li><p><strong>Unsupervised learning</strong> – inputs are unlabelled, the aim is to discover
the underlying structure in the data (e.g., automatically group customers
w.r.t. common behavioural patterns)</p></li>
<li><p><strong>Semi-supervised learning</strong> – some inputs are labelled, the others
are not (definitely a cheaper scenario)</p></li>
<li><p><strong>Reinforcement learning</strong> – learn to act based on a
feedback given after the actual decision was made
(e.g., learn to play The Witcher 7 by testing different hypotheses
what to do to survive as long as possible)</p></li>
</ul>
</div>
</div>
<div id="supervised-learning" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Supervised Learning</h2>
<div id="formalism" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Formalism</h3>
<p>Let <span class="math inline">\(\mathbf{X}=\{\mathfrak{X}_1,\dots,\mathfrak{X}_n\}\)</span>
be an input sample (“a database”)
that consists of <span class="math inline">\(n\)</span> objects.</p>
<p>Most often we assume that each object <span class="math inline">\(\mathfrak{X}_i\)</span>
is represented using <span class="math inline">\(p\)</span> numbers for some <span class="math inline">\(p\)</span>.</p>
<p>We denote this fact as <span class="math inline">\(\mathfrak{X}_i\in \mathbb{R}^p\)</span>
(it is <em>a <span class="math inline">\(p\)</span>-dimensional real vector</em> or
<em>a sequence of <span class="math inline">\(p\)</span> numbers</em> or
<em>a point in a <span class="math inline">\(p\)</span>-dimensional real space</em>
or <em>an element of a real <span class="math inline">\(p\)</span>-space</em> etc.).</p>
<p>If we have “complex” objects on input,
we can always try representing them as <strong>feature vectors</strong> (e.g.,
come up with numeric attributes that best describe them in a task at hand).</p>
<div class="exercise"><strong>Exercise.</strong>
<p>Consider the following problems:</p>
<ol style="list-style-type: decimal">
<li><p>How would you represent a patient in a clinic?</p></li>
<li><p>How would you represent a car in an insurance company’s database?</p></li>
<li><p>How would you represent a student in an university?</p></li>
</ol>
</div>
<p>Of course, our setting is <em>abstract</em> in the sense that
there might be different realities <em>hidden</em> behind these symbols.</p>
<p>This is what maths is for – creating <em>abstractions</em> or <em>models</em>
of complex entities/phenomena so that they can be much more easily manipulated
or understood.
This is very powerful – spend a moment
contemplating how many real-world situations fit into our framework.</p>
<p>This also includes image/video data, e.g., a 1920×1080 pixel image
can be “unwound” to a “flat” vector of length 2,073,600.</p>
<p>(*) There are some algorithms such as Multidimensional Scaling,
Locally Linear Embedding, IsoMap etc.
that can do that automagically.</p>
<div style="margin-top: 1em">

</div>
<p>In cases such as this we say that we deal with <em>structured (tabular) data</em><br />
– <span class="math inline">\(\mathbf{X}\)</span> can be written as an (<span class="math inline">\(n\times p\)</span>)-matrix:
<span class="math display">\[
\mathbf{X}=
\left[
\begin{array}{cccc}
x_{1,1} &amp; x_{1,2} &amp; \cdots &amp; x_{1,p} \\
x_{2,1} &amp; x_{2,2} &amp; \cdots &amp; x_{2,p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
x_{n,1} &amp; x_{n,2} &amp; \cdots &amp; x_{n,p} \\
\end{array}
\right]
\]</span>
Mathematically, we denote this as <span class="math inline">\(\mathbf{X}\in\mathbb{R}^{n\times d}\)</span>.</p>
<dl>
<dt>Remark.</dt>
<dd><p>Structured data == think: Excel/Calc spreadsheets, SQL tables etc.</p>
</dd>
</dl>
<p>For an example, consider the famous Fisher’s Iris flower dataset,
see <code>?iris</code> in R
and <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set" class="uri">https://en.wikipedia.org/wiki/Iris_flower_data_set</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="simple-linear-regression.html#cb1-1" aria-hidden="true"></a>X &lt;-<span class="st"> </span>iris[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="co"># first 6 rows and 4 columns</span></span>
<span id="cb1-2"><a href="simple-linear-regression.html#cb1-2" aria-hidden="true"></a>X         <span class="co"># or: print(X)</span></span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1          5.1         3.5          1.4         0.2
## 2          4.9         3.0          1.4         0.2
## 3          4.7         3.2          1.3         0.2
## 4          4.6         3.1          1.5         0.2
## 5          5.0         3.6          1.4         0.2
## 6          5.4         3.9          1.7         0.4</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="simple-linear-regression.html#cb3-1" aria-hidden="true"></a><span class="kw">dim</span>(X)    <span class="co"># gives n and p</span></span></code></pre></div>
<pre><code>## [1] 6 4</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simple-linear-regression.html#cb5-1" aria-hidden="true"></a><span class="kw">dim</span>(iris) <span class="co"># for the full dataset</span></span></code></pre></div>
<pre><code>## [1] 150   5</code></pre>
<p><span class="math inline">\(x_{i,j}\in\mathbb{R}\)</span>
represents the <span class="math inline">\(j\)</span>-th feature of the <span class="math inline">\(i\)</span>-th observation,
<span class="math inline">\(j=1,\dots,p\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>.</p>
<p>For instance:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="simple-linear-regression.html#cb7-1" aria-hidden="true"></a>X[<span class="dv">3</span>, <span class="dv">2</span>] <span class="co"># 3rd row, 2nd column</span></span></code></pre></div>
<pre><code>## [1] 3.2</code></pre>
<p>The third observation (data point, row in <span class="math inline">\(\mathbf{X}\)</span>)
consists of items <span class="math inline">\((x_{3,1}, \dots, x_{3,p})\)</span> that can be extracted by calling:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="simple-linear-regression.html#cb9-1" aria-hidden="true"></a>X[<span class="dv">3</span>,]</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 3          4.7         3.2          1.3         0.2</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="simple-linear-regression.html#cb11-1" aria-hidden="true"></a><span class="kw">as.numeric</span>(X[<span class="dv">3</span>,]) <span class="co"># drops names</span></span></code></pre></div>
<pre><code>## [1] 4.7 3.2 1.3 0.2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simple-linear-regression.html#cb13-1" aria-hidden="true"></a><span class="kw">length</span>(X[<span class="dv">3</span>,])</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Moreover, the second feature/variable/column
is comprised of
<span class="math inline">\((x_{1,2}, x_{2,2}, \dots, x_{n,2})\)</span>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simple-linear-regression.html#cb15-1" aria-hidden="true"></a>X[,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 3.5 3.0 3.2 3.1 3.6 3.9</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simple-linear-regression.html#cb17-1" aria-hidden="true"></a><span class="kw">length</span>(X[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>We will sometimes use the following notation to emphasise that
the <span class="math inline">\(\mathbf{X}\)</span> matrix consists of <span class="math inline">\(n\)</span> rows
or <span class="math inline">\(p\)</span> columns:</p>
<p><span class="math display">\[
\mathbf{X}=\left[
\begin{array}{c}
\mathbf{x}_{1,\cdot} \\
\mathbf{x}_{2,\cdot} \\
\vdots\\
\mathbf{x}_{n,\cdot} \\
\end{array}
\right]
=
\left[
\begin{array}{cccc}
\mathbf{x}_{\cdot,1} &amp;
\mathbf{x}_{\cdot,2} &amp;
\cdots &amp;
\mathbf{x}_{\cdot,p} \\
\end{array}
\right].
\]</span></p>
<p>Here, <span class="math inline">\(\mathbf{x}_{i,\cdot}\)</span> is a <em>row vector</em> of length <span class="math inline">\(p\)</span>,
i.e., a <span class="math inline">\((1\times p)\)</span>-matrix:</p>
<p><span class="math display">\[
\mathbf{x}_{i,\cdot} = \left[
\begin{array}{cccc}
x_{i,1} &amp;
x_{i,2} &amp;
\cdots &amp;
x_{i,p} \\
\end{array}
\right].
\]</span></p>
<p>Moreover, <span class="math inline">\(\mathbf{x}_{\cdot,j}\)</span> is a <em>column vector</em> of length <span class="math inline">\(n\)</span>,
i.e., an <span class="math inline">\((n\times 1)\)</span>-matrix:</p>
<p><span class="math display">\[
\mathbf{x}_{\cdot,j} = \left[
\begin{array}{cccc}
x_{1,j} &amp;
x_{2,j} &amp;
\cdots &amp;
x_{n,j} \\
\end{array}
\right]^T=\left[
\begin{array}{c}
{x}_{1,j} \\
{x}_{2,j} \\
\vdots\\
{x}_{n,j} \\
\end{array}
\right],
\]</span></p>
<p>where <span class="math inline">\(\cdot^T\)</span> denotes the <em>transpose</em> of a given matrix –
think of this as a kind of rotation; it allows us to introduce a set of
“vertically stacked” objects using a single inline formula.</p>
</div>
<div id="desired-outputs" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Desired Outputs</h3>
<p>In supervised learning,
apart from the inputs we are also given the corresponding
reference/desired outputs.</p>
<p>The aim of supervised learning is to try to create an “algorithm” that,
given an input point, generates an output that is as <em>close</em> as possible
to the desired one. The given data sample will be used to “train” this “model”.</p>
<p>Usually the reference outputs are encoded as individual numbers (scalars)
or textual labels.</p>
<p>In other words, with each input <span class="math inline">\(\mathbf{x}_{i,\cdot}\)</span> we associate
the desired output <span class="math inline">\(y_i\)</span>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simple-linear-regression.html#cb19-1" aria-hidden="true"></a><span class="co"># in iris, iris[, 5] gives the Ys</span></span>
<span id="cb19-2"><a href="simple-linear-regression.html#cb19-2" aria-hidden="true"></a>iris[<span class="kw">sample</span>(<span class="kw">nrow</span>(iris), <span class="dv">3</span>), ]  <span class="co"># three random rows</span></span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 14           4.3         3.0          1.1         0.1    setosa
## 50           5.0         3.3          1.4         0.2    setosa
## 118          7.7         3.8          6.7         2.2 virginica</code></pre>
<p>Hence, our dataset is <span class="math inline">\([\mathbf{X}\ \mathbf{y}]\)</span> –
each object is represented as a row vector
<span class="math inline">\([\mathbf{x}_{i,\cdot}\ y_i]\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>:</p>
<p><span class="math display">\[
[\mathbf{X}\ \mathbf{y}]=
\left[
\begin{array}{ccccc}
x_{1,1} &amp; x_{1,2} &amp; \cdots &amp; x_{1,p} &amp; y_1\\
x_{2,1} &amp; x_{2,2} &amp; \cdots &amp; x_{2,p} &amp; y_2\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots    &amp; \vdots\\
x_{n,1} &amp; x_{n,2} &amp; \cdots &amp; x_{n,p} &amp; y_n\\
\end{array}
\right],
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
\mathbf{y} = \left[
\begin{array}{cccc}
y_{1} &amp;
y_{2} &amp;
\cdots &amp;
y_{n} \\
\end{array}
\right]^T=\left[
\begin{array}{c}
{y}_{1} \\
{y}_{2} \\
\vdots\\
{y}_{n} \\
\end{array}
\right].
\]</span></p>
</div>
<div id="types-of-supervised-learning-problems" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Types of Supervised Learning Problems</h3>
<p>Depending on the type of the elements in <span class="math inline">\(\mathbf{y}\)</span>
(the domain of <span class="math inline">\(\mathbf{y}\)</span>),
supervised learning problems are usually
classified as:</p>
<ul>
<li><p><strong>regression</strong> – each <span class="math inline">\(y_i\)</span> is a real number</p>
<p>e.g., <span class="math inline">\(y_i=\)</span> future market stock price
with <span class="math inline">\(\mathbf{x}_{i,\cdot}=\)</span> prices from <span class="math inline">\(p\)</span> previous days</p></li>
<li><p><strong>classification</strong> – each <span class="math inline">\(y_i\)</span> is a discrete label</p>
<p>e.g., <span class="math inline">\(y_i=\)</span> healthy (0) or ill (1)
with <span class="math inline">\(\mathbf{x}_{i,\cdot}=\)</span> a patient’s health record</p></li>
<li><p><strong>ordinal regression</strong> (a.k.a. ordinal classification) – each <span class="math inline">\(y_i\)</span> is a rank</p>
<p>e.g., <span class="math inline">\(y_i=\)</span> rating of a product on the scale 1–5
with <span class="math inline">\(\mathbf{x}_{i,\cdot}=\)</span> ratings of <span class="math inline">\(p\)</span> most similar products</p></li>
</ul>
<div class="exercise"><strong>Exercise.</strong>
<p>Example Problems – Discussion:</p>
<p>Which of the following are instances of classification problems? Which of them are regression tasks?</p>
<p>What kind of data should you gather in order to tackle them?</p>
<ul>
<li>Detect email spam</li>
<li>Predict a market stock price</li>
<li>Predict the likeability of a new ad</li>
<li>Assess credit risk</li>
<li>Detect tumour tissues in medical images</li>
<li>Predict time-to-recovery of cancer patients</li>
<li>Recognise smiling faces on photographs</li>
<li>Detect unattended luggage in airport security camera footage</li>
<li>Turn on emergency braking to avoid a collision with pedestrians</li>
</ul>
</div>
<p>A single dataset can become an instance of many different ML problems.</p>
<p>Examples – the <code>wines</code> dataset:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="simple-linear-regression.html#cb21-1" aria-hidden="true"></a>wines &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;datasets/winequality-all.csv&quot;</span>, <span class="dt">comment=</span><span class="st">&quot;#&quot;</span>)</span>
<span id="cb21-2"><a href="simple-linear-regression.html#cb21-2" aria-hidden="true"></a>wines[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>##   fixed.acidity volatile.acidity citric.acid residual.sugar chlorides
## 1           7.4              0.7           0            1.9     0.076
##   free.sulfur.dioxide total.sulfur.dioxide density   pH sulphates
## 1                  11                   34  0.9978 3.51      0.56
##   alcohol response color
## 1     9.4        5   red</code></pre>
<p><code>alcohol</code> is a numeric (quantitative) variable (see Figure <a href="simple-linear-regression.html#fig:wines-regression">1.1</a> for a histogram depicting its empirical distribution):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="simple-linear-regression.html#cb23-1" aria-hidden="true"></a><span class="kw">summary</span>(wines<span class="op">$</span>alcohol) <span class="co"># continuous variable</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     8.0     9.5    10.3    10.5    11.3    14.9</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="simple-linear-regression.html#cb25-1" aria-hidden="true"></a><span class="kw">hist</span>(wines<span class="op">$</span>alcohol, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>); <span class="kw">box</span>()</span></code></pre></div>
<div class="figure"><span id="fig:wines-regression"></span>
<img src="01-regression-simple-figures/wines-regression-1.png" alt="" />
<p class="caption">Figure 1.1:  Quantitative (numeric) outputs lead to regression problems</p>
</div>
<p><code>color</code> is a quantitative variable with two possible outcomes (see Figure <a href="simple-linear-regression.html#fig:wines-binary">1.2</a> for a bar plot):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="simple-linear-regression.html#cb26-1" aria-hidden="true"></a><span class="kw">table</span>(wines<span class="op">$</span>color) <span class="co"># binary variable</span></span></code></pre></div>
<pre><code>## 
##   red white 
##  1599  4898</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="simple-linear-regression.html#cb28-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(wines<span class="op">$</span>color), <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6000</span>))</span></code></pre></div>
<div class="figure"><span id="fig:wines-binary"></span>
<img src="01-regression-simple-figures/wines-binary-1.png" alt="" />
<p class="caption">Figure 1.2:  Quantitative outputs lead to classification tasks</p>
</div>
<p>Moreover, <code>response</code> is an ordinal variable, representing
a wine’s rating as assigned by a wine expert
(see Figure <a href="simple-linear-regression.html#fig:wines-ordinal">1.3</a> for a barplot).
Note that although the ranks are represented with numbers,
we they are not continuous variables. Moreover,
these ranks are something more than just labels – they are linearly
ordered, we know what’s the smallest rank and whats the greatest one.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="simple-linear-regression.html#cb29-1" aria-hidden="true"></a><span class="kw">table</span>(wines<span class="op">$</span>response) <span class="co"># ordinal variable</span></span></code></pre></div>
<pre><code>## 
##    3    4    5    6    7    8    9 
##   30  216 2138 2836 1079  193    5</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="simple-linear-regression.html#cb31-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(wines<span class="op">$</span>response), <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3000</span>))</span></code></pre></div>
<div class="figure"><span id="fig:wines-ordinal"></span>
<img src="01-regression-simple-figures/wines-ordinal-1.png" alt="" />
<p class="caption">Figure 1.3:  Ordinal variables constitute ordinal regression tasks</p>
</div>
</div>
</div>
<div id="simple-regression" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Simple Regression</h2>
<div id="introduction" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Introduction</h3>
<p><strong>Simple regression</strong> is the easiest setting to start with – let’s assume
<span class="math inline">\(p=1\)</span>, i.e., all inputs are 1-dimensional.
Denote <span class="math inline">\(x_i=x_{i,1}\)</span>.</p>
<p>We will use it to build many intuitions, for example, it’ll be easy
to illustrate all the concepts graphically.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="simple-linear-regression.html#cb32-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;ISLR&quot;</span>) <span class="co"># Credit dataset</span></span>
<span id="cb32-2"><a href="simple-linear-regression.html#cb32-2" aria-hidden="true"></a><span class="kw">plot</span>(Credit<span class="op">$</span>Balance, Credit<span class="op">$</span>Rating) <span class="co"># scatter plot</span></span></code></pre></div>
<div class="figure"><span id="fig:credit-scatter"></span>
<img src="01-regression-simple-figures/credit-scatter-1.png" alt="" />
<p class="caption">Figure 1.4:  A scatter plot of Rating vs. Balance</p>
</div>
<p>In what follows we will be modelling the Credit Rating (<span class="math inline">\(Y\)</span>)
as a function of the average Credit Card Balance (<span class="math inline">\(X\)</span>) in USD
for customers <em>with positive Balance only</em>.
It is because it is evident from Figure <a href="simple-linear-regression.html#fig:credit-scatter">1.4</a>
that some customers with zero balance obtained a credit rating
based on some external data source that we don’t have access to in
our very setting.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="simple-linear-regression.html#cb33-1" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">as.numeric</span>(Credit<span class="op">$</span>Balance[Credit<span class="op">$</span>Balance<span class="op">&gt;</span><span class="dv">0</span>]))</span>
<span id="cb33-2"><a href="simple-linear-regression.html#cb33-2" aria-hidden="true"></a>Y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">as.numeric</span>(Credit<span class="op">$</span>Rating[Credit<span class="op">$</span>Balance<span class="op">&gt;</span><span class="dv">0</span>]))</span></code></pre></div>
<p>Figure <a href="simple-linear-regression.html#fig:credit-XY-plot">1.5</a> gives the updated scatter plot
with the zero-balance clients “taken care of”.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="simple-linear-regression.html#cb34-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">xlab=</span><span class="st">&quot;X (Balance)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Y (Rating)&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:credit-XY-plot"></span>
<img src="01-regression-simple-figures/credit-XY-plot-1.png" alt="" />
<p class="caption">Figure 1.5:  A scatter plot of Rating vs. Balance with clients of Balance=0 removed</p>
</div>
<p>Our aim is to construct a function <span class="math inline">\(f\)</span> that
<strong>models</strong> Rating as a function of Balance,
<span class="math inline">\(f(X)=Y\)</span>.</p>
<p>We are equipped with <span class="math inline">\(n=310\)</span> reference (observed) Ratings
<span class="math inline">\(\mathbf{y}=[y_1\ \cdots\ y_n]^T\)</span>
for particular Balances <span class="math inline">\(\mathbf{x}=[x_1\ \cdots\ x_n]^T\)</span>.</p>
<p>Note the following naming conventions:</p>
<ul>
<li><p>Variable types:</p>
<ul>
<li><p><span class="math inline">\(X\)</span> – independent/explanatory/predictor variable</p></li>
<li><p><span class="math inline">\(Y\)</span> – dependent/response/predicted variable</p></li>
</ul></li>
<li><p>Also note that:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> – idealisation (any possible Rating)</p></li>
<li><p><span class="math inline">\(\mathbf{y}=[y_1\ \cdots\ y_n]^T\)</span> – values actually observed</p></li>
</ul></li>
</ul>
<p>The model will not be ideal, but it might be usable:</p>
<ul>
<li><p>We will be able to <strong>predict</strong> the rating of any new client.</p>
<p>What should be the rating of a client with Balance of $1500?</p>
<p>What should be the rating of a client with Balance of $2500?</p></li>
<li><p>We will be able to <strong>describe</strong> (understand) this reality using a single mathematical formula
so as to infer that there is an association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></p>
<p>Think of “data compression” and laws of physics, e.g., <span class="math inline">\(E=mc^2\)</span>.</p></li>
</ul>
<p>(*) Mathematically, we will assume that there is some “true” function that models the data
(true relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>),
but the observed outputs are subject to <strong>additive error</strong>:
<span class="math display">\[Y=f(X)+\varepsilon.\]</span></p>
<p><span class="math inline">\(\varepsilon\)</span> is a random term, classically we assume that
errors are independent of each other,
have expected value of <span class="math inline">\(0\)</span> (there is no systematic error = unbiased)
and that they follow a normal distribution.</p>
<p>(*) We denote this as <span class="math inline">\(\varepsilon\sim\mathcal{N}(0, \sigma)\)</span>
(read: random variable <span class="math inline">\(\varepsilon\)</span> follows a normal distribution
with expected value of <span class="math inline">\(0\)</span> and standard deviation of <span class="math inline">\(\sigma\)</span> for some <span class="math inline">\(\sigma\ge 0\)</span>).</p>
<p><span class="math inline">\(\sigma\)</span> controls the amount of noise (and hence, uncertainty).
Figure <a href="simple-linear-regression.html#fig:normal-distribs">1.6</a> gives the plot of the probability
distribution function (PDFs, densities)
of <span class="math inline">\(\mathcal{N}(0, \sigma)\)</span> for different <span class="math inline">\(\sigma\)</span>s:</p>
<div class="figure"><span id="fig:normal-distribs"></span>
<img src="01-regression-simple-figures/normal-distribs-1.png" alt="" />
<p class="caption">Figure 1.6:  Probability density functions of normal distributions with different standard deviations <span class="math inline">\(\sigma\)</span>.</p>
</div>
</div>
<div id="search-space-and-objective" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Search Space and Objective</h3>
<p>There are many different functions that can be <strong>fitted</strong> into
the observed <span class="math inline">\((\mathbf{x},\mathbf{y})\)</span>,
compare Figure <a href="simple-linear-regression.html#fig:credit-different-models">1.7</a>.
Some of them are better than the other (with respect to
different aspects, such as fit quality, simplicity etc.).</p>
<div class="figure"><span id="fig:credit-different-models"></span>
<img src="01-regression-simple-figures/credit-different-models-1.png" alt="" />
<p class="caption">Figure 1.7:  Different polynomial models fitted to data</p>
</div>
<p>Thus, we need a formal <strong>model selection criterion</strong>
that could enable as to tackle the model fitting
task on a computer.</p>
<p>Usually, we will be interested in a model
that minimises appropriately aggregated <strong>residuals</strong>
<span class="math inline">\(f(x_i)-y_i\)</span>, i.e.,
<strong>predicted outputs minus observed outputs</strong>,
often denoted with <span class="math inline">\(\hat{y}_i-y_i\)</span>,
for <span class="math inline">\(i=1,\dots,n\)</span>.</p>
<div class="figure"><span id="fig:credit-residuals"></span>
<img src="01-regression-simple-figures/credit-residuals-1.png" alt="" />
<p class="caption">Figure 1.8:  Residuals are defined as the differences between the predicted and observed outputs <span class="math inline">\(\hat{y}_i-y_i\)</span></p>
</div>
<p>In Figure <a href="simple-linear-regression.html#fig:credit-residuals">1.8</a>, the residuals correspond to the
lengths of the dashed line segments – they measure the discrepancy between
the outputs generated by the model (what we get)
and the true outputs (what we want).</p>
<blockquote>
<p>Note that some sources define residuals as <span class="math inline">\(y_i-\hat{y}_i=y_i-f(x_i)\)</span>.</p>
</blockquote>
<p>Top choice: sum of squared residuals:
<span class="math display">\[
\begin{array}{rl}
\mathrm{SSR}(f|\mathbf{x},\mathbf{y})
&amp; = \left( f(x_1)-y_1 \right)^2 + \dots + \left( f(x_n)-y_n \right)^2 \\
&amp; =
\displaystyle\sum_{i=1}^n \left( f(x_i)-y_i \right)^2
\end{array}
\]</span></p>
<dl>
<dt>Remark.</dt>
<dd><p>Read “<span class="math inline">\(\sum_{i=1}^n z_i\)</span>” as “the sum of <span class="math inline">\(z_i\)</span> for <span class="math inline">\(i\)</span> from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>”;
this is just a shorthand for <span class="math inline">\(z_1+z_2+\dots+z_n\)</span>.</p>
</dd>
<dt>Remark.</dt>
<dd><p>The notation <span class="math inline">\(\mathrm{SSR}(f|\mathbf{x},\mathbf{y})\)</span> means that
it is the error measure
corresponding to the model <span class="math inline">\((f)\)</span> <em>given</em> our data.<br />
We could’ve denoted it with <span class="math inline">\(\mathrm{SSR}_{\mathbf{x},\mathbf{y}}(f)\)</span>
or even <span class="math inline">\(\mathrm{SSR}(f)\)</span> to emphasise that <span class="math inline">\(\mathbf{x},\mathbf{y}\)</span>
are just fixed values and we are not interested
in changing them at all (they are “global variables”).</p>
</dd>
</dl>
<p>We enjoy SSR because (amongst others):</p>
<ul>
<li><p>larger errors are penalised much more than smaller ones</p>
<blockquote>
<p>(this can be considered a drawback as well)</p>
</blockquote></li>
<li><p>(**) statistically speaking, this has a clear underlying interpretation</p>
<blockquote>
<p>(assuming errors are normally distributed,
finding a model minimising the SSR is equivalent
to maximum likelihood estimation)</p>
</blockquote></li>
<li><p>the models minimising the SSR can often be found easily</p>
<blockquote>
<p>(corresponding optimisation tasks have an analytic solution –
studied already by Gauss in the late 18th century)</p>
</blockquote></li>
</ul>
<p>(**) Other choices:</p>
<ul>
<li>regularised SSR, e.g., lasso or ridge regression (in the case of multiple input variables)</li>
<li>sum or median of absolute values (robust regression)</li>
</ul>
<p>Fitting a model to data can be written as an optimisation problem:</p>
<p><span class="math display">\[
\min_{f\in\mathcal{F}} \mathrm{SSR}(f|\mathbf{x},\mathbf{y}),
\]</span></p>
<p>i.e., find <span class="math inline">\(f\)</span> minimising the SSR <strong>(seek “best” <span class="math inline">\(f\)</span>)</strong><br />
amongst the set of admissible models <span class="math inline">\(\mathcal{F}\)</span>.</p>
<p>Example <span class="math inline">\(\mathcal{F}\)</span>s:</p>
<ul>
<li><p><span class="math inline">\(\mathcal{F}=\{\text{All possible functions of one variable}\}\)</span> – if there are no repeated
<span class="math inline">\(x_i\)</span>’s, this corresponds to data <em>interpolation</em>; note that there
are many functions that give SSR of <span class="math inline">\(0\)</span>.</p></li>
<li><p><span class="math inline">\(\mathcal{F}=\{ x\mapsto x^2, x\mapsto \cos(x), x\mapsto \exp(2x+7)-9 \}\)</span> – obviously
an ad-hoc choice but you can easily choose the best amongst the 3 by computing 3 sums of squares.</p></li>
<li><p><span class="math inline">\(\mathcal{F}=\{ x\mapsto a+bx\}\)</span> – the space of linear functions of one variable</p></li>
<li><p>etc.</p></li>
</ul>
<p>(e.g., <span class="math inline">\(x\mapsto x^2\)</span> is read “<span class="math inline">\(x\)</span> maps to <span class="math inline">\(x^2\)</span>” and is
an elegant way to define an inline function <span class="math inline">\(f\)</span> such that <span class="math inline">\(f(x)=x^2\)</span>)</p>
</div>
</div>
<div id="simple-linear-regression-1" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Simple Linear Regression</h2>
<div id="introduction-1" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Introduction</h3>
<p>If the family of admissible models <span class="math inline">\(\mathcal{F}\)</span> consists only of all linear functions of one variable,
we deal with a <strong>simple linear regression</strong>.</p>
<p>Our problem becomes:</p>
<p><span class="math display">\[
\min_{a,b\in\mathbb{R}} \sum_{i=1}^n \left(
a+bx_i-y_i
\right)^2
\]</span></p>
<p>In other words, we seek best fitting line in terms of the squared residuals.</p>
<p>This is the <strong>method of least squares</strong>.</p>
<p>This is particularly nice, because our search space
is just <span class="math inline">\(\mathbb{R}^2\)</span> – easy to handle both analytically and numerically.</p>
<div class="figure"><span id="fig:credit-different-lines-ssr"></span>
<img src="01-regression-simple-figures/credit-different-lines-ssr-1.png" alt="" />
<p class="caption">Figure 1.9:  Three simple linear models together with the corresponding SSRs</p>
</div>
<div class="exercise"><strong>Exercise.</strong>
<p>Which of the lines in Figure <a href="simple-linear-regression.html#fig:credit-different-lines-ssr">1.9</a> is the least squares solution?</p>
</div>
<!-- TODO:
heatmap of SSR(a,b) for a = [0,1], b=[0,300]
-->
</div>
<div id="solution-in-r" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Solution in R</h3>
<p>Let’s fit the linear model minimising the SSR in R.
The <code>lm()</code> function (<code>l</code>inear <code>m</code>odels) has a convenient <em>formula</em>-based interface.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="simple-linear-regression.html#cb35-1" aria-hidden="true"></a>f &lt;-<span class="st"> </span><span class="kw">lm</span>(Y<span class="op">~</span>X)</span></code></pre></div>
<p>In R, the expression “<code>Y~X</code>” denotes a formula, which we read as:
variable <code>Y</code> is a function of <code>X</code>.
Note that the dependent variable is on the left side of the formula.
Here, <code>X</code> and <code>Y</code> are two R numeric vectors of identical lengths.</p>
<p>Let’s print the fitted model:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="simple-linear-regression.html#cb36-1" aria-hidden="true"></a><span class="kw">print</span>(f)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Coefficients:
## (Intercept)            X  
##     226.471        0.266</code></pre>
<p>Hence, the fitted model is:
<span class="math display">\[
Y = f(X) = 226.47114+0.26615 X
\qquad (+ \varepsilon)
\]</span></p>
<p>Coefficient <span class="math inline">\(a\)</span> (intercept):</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="simple-linear-regression.html#cb38-1" aria-hidden="true"></a>f<span class="op">$</span>coefficient[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## (Intercept) 
##      226.47</code></pre>
<p>Coefficient <span class="math inline">\(b\)</span> (slope):</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="simple-linear-regression.html#cb40-1" aria-hidden="true"></a>f<span class="op">$</span>coefficient[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>##       X 
## 0.26615</code></pre>
<p>Plotting, see Figure <a href="simple-linear-regression.html#fig:credit-plot-lm">1.10</a>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="simple-linear-regression.html#cb42-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">col=</span><span class="st">&quot;#000000aa&quot;</span>)</span>
<span id="cb42-2"><a href="simple-linear-regression.html#cb42-2" aria-hidden="true"></a><span class="kw">abline</span>(f, <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span id="fig:credit-plot-lm"></span>
<img src="01-regression-simple-figures/credit-plot-lm-1.png" alt="" />
<p class="caption">Figure 1.10:  Fitted regression line</p>
</div>
<p>SSR:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="simple-linear-regression.html#cb43-1" aria-hidden="true"></a><span class="kw">sum</span>(f<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2132108</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="simple-linear-regression.html#cb45-1" aria-hidden="true"></a><span class="kw">sum</span>((f<span class="op">$</span>coefficient[<span class="dv">1</span>]<span class="op">+</span>f<span class="op">$</span>coefficient[<span class="dv">2</span>]<span class="op">*</span>X<span class="op">-</span>Y)<span class="op">^</span><span class="dv">2</span>) <span class="co"># equivalent</span></span></code></pre></div>
<pre><code>## [1] 2132108</code></pre>
<p>We can predict the model’s output for yet-unobserved inputs by
writing:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="simple-linear-regression.html#cb47-1" aria-hidden="true"></a>X_new &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1500</span>, <span class="dv">2000</span>, <span class="dv">2500</span>) <span class="co"># example inputs</span></span>
<span id="cb47-2"><a href="simple-linear-regression.html#cb47-2" aria-hidden="true"></a>f<span class="op">$</span>coefficient[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>f<span class="op">$</span>coefficient[<span class="dv">2</span>]<span class="op">*</span>X_new</span></code></pre></div>
<pre><code>## [1] 625.69 758.76 891.84</code></pre>
<p>Note that linear models can also be fitted based on formulas that refer
to a data frame’s columns. For example, let us wrap
both <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> inside a data frame:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="simple-linear-regression.html#cb49-1" aria-hidden="true"></a>XY &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Balance=</span>X, <span class="dt">Rating=</span>Y)</span>
<span id="cb49-2"><a href="simple-linear-regression.html#cb49-2" aria-hidden="true"></a><span class="kw">head</span>(XY, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   Balance Rating
## 1     333    283
## 2     903    483
## 3     580    514</code></pre>
<p>By writing:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="simple-linear-regression.html#cb51-1" aria-hidden="true"></a>f &lt;-<span class="st"> </span><span class="kw">lm</span>(Rating<span class="op">~</span>Balance, <span class="dt">data=</span>XY)</span></code></pre></div>
<p>now <code>Balance</code> and <code>Rating</code> refer to column names in the <code>XY</code> data frame,
and not the objects in R’s “workspace”.</p>
<p>Based on the above, we can make a prediction
using the <code>predict()</code> function"</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="simple-linear-regression.html#cb52-1" aria-hidden="true"></a>X_new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Balance=</span><span class="kw">c</span>(<span class="dv">1500</span>, <span class="dv">2000</span>, <span class="dv">2500</span>))</span>
<span id="cb52-2"><a href="simple-linear-regression.html#cb52-2" aria-hidden="true"></a><span class="kw">predict</span>(f, X_new)</span></code></pre></div>
<pre><code>##      1      2      3 
## 625.69 758.76 891.84</code></pre>
<p>Interestingly:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="simple-linear-regression.html#cb54-1" aria-hidden="true"></a><span class="kw">predict</span>(f, <span class="kw">data.frame</span>(<span class="dt">Balance=</span><span class="kw">c</span>(<span class="dv">5000</span>)))</span></code></pre></div>
<pre><code>##      1 
## 1557.2</code></pre>
<p>This is more than the highest possible rating – we have extrapolated
way beyond the observable data range.</p>
<p>Note that our <span class="math inline">\(Y=a+bX\)</span> model is <strong>interpretable</strong>
and <strong>well-behaving</strong>
(not all machine learning models will have this feature,
think: deep neural networks,
which we rather conceive as <em>black boxes</em>):</p>
<ul>
<li><p>we know that by increasing <span class="math inline">\(X\)</span> by a small amount,
<span class="math inline">\(Y\)</span> will also increase (positive correlation),</p></li>
<li><p>the model is continuous – small change in <span class="math inline">\(X\)</span>
doesn’t yield any drastic change in <span class="math inline">\(Y\)</span>,</p></li>
<li><p>we know what will happen if we increase or decrease <span class="math inline">\(X\)</span> by, say, <span class="math inline">\(100\)</span>,</p></li>
<li><p>the function is invertible – if we want Rating of <span class="math inline">\(500\)</span>,
we can compute the associated preferred Balance that should yield it
(provided that the model is valid).</p></li>
</ul>
</div>
<div id="analytic-solution" class="section level3" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Analytic Solution</h3>
<p>It may be shown (which we actually do below)
that the solution is:</p>
<p><span class="math display">\[
\left\{
\begin{array}{rl}
b  = &amp; \dfrac{
n \displaystyle\sum_{i=1}^n x_i y_i - \displaystyle\sum_{i=1}^n  y_i \displaystyle\sum_{i=1}^n x_i
}{
n \displaystyle\sum_{i=1}^n x_i x_i -   \displaystyle\sum_{i=1}^n x_i\displaystyle\sum_{i=1}^n x_i
}\\
a = &amp; \dfrac{1}{n}\displaystyle\sum_{i=1}^n  y_i - b  \dfrac{1}{n} \displaystyle\sum_{i=1}^n x_i  \\
\end{array}
\right.
\]</span></p>
<p>Which can be implemented in R as follows:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="simple-linear-regression.html#cb56-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(X)</span>
<span id="cb56-2"><a href="simple-linear-regression.html#cb56-2" aria-hidden="true"></a>b &lt;-<span class="st"> </span>(n<span class="op">*</span><span class="kw">sum</span>(X<span class="op">*</span>Y)<span class="op">-</span><span class="kw">sum</span>(X)<span class="op">*</span><span class="kw">sum</span>(Y))<span class="op">/</span>(n<span class="op">*</span><span class="kw">sum</span>(X<span class="op">*</span>X)<span class="op">-</span><span class="kw">sum</span>(X)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb56-3"><a href="simple-linear-regression.html#cb56-3" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="kw">mean</span>(Y)<span class="op">-</span>b<span class="op">*</span><span class="kw">mean</span>(X)</span>
<span id="cb56-4"><a href="simple-linear-regression.html#cb56-4" aria-hidden="true"></a><span class="kw">c</span>(a, b) <span class="co"># the same as f$coefficients</span></span></code></pre></div>
<pre><code>## [1] 226.47114   0.26615</code></pre>
</div>
<div id="derivation-of-the-solution" class="section level3" number="1.4.4">
<h3><span class="header-section-number">1.4.4</span> Derivation of the Solution (**)</h3>
<dl>
<dt>Remark.</dt>
<dd><p>You can safely skip this part if you are yet to know
how to search for a minimum of a function of many variables
and what are partial derivatives.</p>
</dd>
</dl>
<p>Denote with:</p>
<p><span class="math display">\[
E(a,b)=\mathrm{SSR}(x\mapsto a+bx|\mathbf{x},\mathbf{y})
=\sum_{i=1}^n \left( a+bx_i - y_i \right) ^2.
\]</span></p>
<p>We seek the minimum of <span class="math inline">\(E\)</span> w.r.t. both <span class="math inline">\(a,b\)</span>.</p>
<dl>
<dt>Theorem.</dt>
<dd><p>If <span class="math inline">\(E\)</span> has a (local) minimum at <span class="math inline">\((a^*,b^*)\)</span>,
then its partial derivatives vanish therein,
i.e., <span class="math inline">\(\partial E/\partial a(a^*, b^*) = 0\)</span> and <span class="math inline">\(\partial E/\partial b(a^*, b^*)=0\)</span>.</p>
</dd>
</dl>
<p>We have:</p>
<p><span class="math display">\[
E(a,b)   = \displaystyle\sum_{i=1}^n \left( a+bx_i - y_i \right) ^2.
\]</span></p>
<p>We need to compute the partial derivatives <span class="math inline">\(\partial E/\partial a\)</span> (derivative of <span class="math inline">\(E\)</span>
w.r.t. variable <span class="math inline">\(a\)</span> – all other terms treated as constants)
and <span class="math inline">\(\partial E/\partial b\)</span> (w.r.t. <span class="math inline">\(b\)</span>).</p>
<p>Useful rules – derivatives w.r.t. <span class="math inline">\(a\)</span> (denote <span class="math inline">\(f&#39;(a)=(f(a))&#39;\)</span>):</p>
<ul>
<li><span class="math inline">\((f(a)+g(a))&#39;=f&#39;(a)+g&#39;(a)\)</span> (derivative of sum is sum of derivatives)</li>
<li><span class="math inline">\((f(a) g(a))&#39; = f&#39;(a)g(a) + f(a)g&#39;(a)\)</span> (derivative of product)</li>
<li><span class="math inline">\((f(g(a)))&#39; = f&#39;(g(a)) g&#39;(a)\)</span> (chain rule)</li>
<li><span class="math inline">\((c)&#39; = 0\)</span> for any constant <span class="math inline">\(c\)</span> (expression not involving <span class="math inline">\(a\)</span>)</li>
<li><span class="math inline">\((a^p)&#39; = pa^{p-1}\)</span> for any <span class="math inline">\(p\)</span></li>
<li>in particular: <span class="math inline">\((c a^2+d)&#39;=2ca\)</span>, <span class="math inline">\((ca)&#39;=c\)</span>, <span class="math inline">\(((ca+d)^2)&#39;=2(ca+d)c\)</span> (application of the above rules)</li>
</ul>
<!--\[
\begin{array}{rl}
E_a'(a,b)=&2\displaystyle\sum_{i=1}^n \left( a+bx_i - y_i \right) x_i \\
E_b'(a,b)=&2\displaystyle\sum_{i=1}^n \left( a+bx_i - y_i \right) \\
\end{array}
\]-->
<p>We seek <span class="math inline">\(a,b\)</span> such that <span class="math inline">\(\frac{\partial E}{\partial a}(a,b) = 0\)</span>
and <span class="math inline">\(\frac{\partial E}{\partial b}(a,b)=0\)</span>.</p>
<p><span class="math display">\[
\left\{
\begin{array}{rl}
\frac{\partial E}{\partial a}(a,b)=&amp;2\displaystyle\sum_{i=1}^n \left( a+bx_i - y_i \right) = 0\\
\frac{\partial E}{\partial b}(a,b)=&amp;2\displaystyle\sum_{i=1}^n \left( a+bx_i - y_i \right) x_i = 0 \\
\end{array}
\right.
\]</span></p>
<p>This is a system of 2 linear equations. Easy.</p>
<p>Rearranging like back in the school days:</p>
<p><span class="math display">\[
\left\{
\begin{array}{rl}
b \displaystyle\sum_{i=1}^n x_i+ a n = &amp; \displaystyle\sum_{i=1}^n  y_i  \\
b \displaystyle\sum_{i=1}^n x_i x_i + a \displaystyle\sum_{i=1}^n x_i = &amp; \displaystyle\sum_{i=1}^n x_i y_i \\
\end{array}
\right.
\]</span></p>
<p>It is left as an exercise to show that the solution is:</p>
<p><span class="math display">\[
\left\{
\begin{array}{rl}
b^*  = &amp; \dfrac{
n \displaystyle\sum_{i=1}^n x_i y_i - \displaystyle\sum_{i=1}^n  y_i \displaystyle\sum_{i=1}^n x_i
}{
n \displaystyle\sum_{i=1}^n x_i x_i -   \displaystyle\sum_{i=1}^n x_i\displaystyle\sum_{i=1}^n x_i
}\\
a^* = &amp; \dfrac{1}{n}\displaystyle\sum_{i=1}^n  y_i - b^*  \dfrac{1}{n} \displaystyle\sum_{i=1}^n x_i  \\
\end{array}
\right.
\]</span></p>
<p>(we should additionally perform the second derivative test
to assure that this is the minimum of <span class="math inline">\(E\)</span> – which is exactly the case though)</p>
<!-- TODO rewrite nicely with means and correlation coefficients etc.

Pearson's r introduced in the next chapter though

(a <- cor(x,y)*sd(y)/sd(x))
(b <- mean(y)-a*mean(x))
-->
<p>(**) In the next chapter, we will introduce the notion of Pearson’s
linear coefficient, <span class="math inline">\(r\)</span> (see <code>cor()</code> in R). It might be shown that
<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> can also be rewritten as:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="simple-linear-regression.html#cb58-1" aria-hidden="true"></a>(b &lt;-<span class="st"> </span><span class="kw">cor</span>(X,Y)<span class="op">*</span><span class="kw">sd</span>(Y)<span class="op">/</span><span class="kw">sd</span>(X))</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 0.26615</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="simple-linear-regression.html#cb60-1" aria-hidden="true"></a>(a &lt;-<span class="st"> </span><span class="kw">mean</span>(Y)<span class="op">-</span>b<span class="op">*</span><span class="kw">mean</span>(X))</span></code></pre></div>
<pre><code>##        [,1]
## [1,] 226.47</code></pre>
<!-- TODO show optim() -->
</div>
</div>
<div id="exercises-in-r" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Exercises in R</h2>
<div id="the-anscombe-quartet" class="section level3" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> The Anscombe Quartet</h3>
<p>Here is a famous illustrative example proposed by
the statistician Francis Anscombe in the early 1970s.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="simple-linear-regression.html#cb62-1" aria-hidden="true"></a><span class="kw">print</span>(anscombe) <span class="co"># `anscombe` is a built-in object</span></span></code></pre></div>
<pre><code>##    x1 x2 x3 x4    y1   y2    y3    y4
## 1  10 10 10  8  8.04 9.14  7.46  6.58
## 2   8  8  8  8  6.95 8.14  6.77  5.76
## 3  13 13 13  8  7.58 8.74 12.74  7.71
## 4   9  9  9  8  8.81 8.77  7.11  8.84
## 5  11 11 11  8  8.33 9.26  7.81  8.47
## 6  14 14 14  8  9.96 8.10  8.84  7.04
## 7   6  6  6  8  7.24 6.13  6.08  5.25
## 8   4  4  4 19  4.26 3.10  5.39 12.50
## 9  12 12 12  8 10.84 9.13  8.15  5.56
## 10  7  7  7  8  4.82 7.26  6.42  7.91
## 11  5  5  5  8  5.68 4.74  5.73  6.89</code></pre>
<p>What we see above is a single data frame
that encodes four separate datasets:
<code>anscombe$x1</code> and <code>anscombe$y1</code> define the first pair of variables,
<code>anscombe$x2</code> and <code>anscombe$y2</code> define the second pair and so forth.</p>
<div class="exercise"><strong>Exercise.</strong>
<p>Split the above data (manually) into four data frames
<code>ans1</code>, …, <code>ans4</code> with columns <code>x</code> and <code>y</code>.</p>
<p>For example, <code>ans1</code> should look like:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="simple-linear-regression.html#cb64-1" aria-hidden="true"></a><span class="kw">print</span>(ans1)</span></code></pre></div>
<pre><code>##     x     y
## 1  10  8.04
## 2   8  6.95
## 3  13  7.58
## 4   9  8.81
## 5  11  8.33
## 6  14  9.96
## 7   6  7.24
## 8   4  4.26
## 9  12 10.84
## 10  7  4.82
## 11  5  5.68</code></pre>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="simple-linear-regression.html#cb66-1" aria-hidden="true"></a>ans1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>anscombe<span class="op">$</span>x1, <span class="dt">y=</span>anscombe<span class="op">$</span>y1)</span>
<span id="cb66-2"><a href="simple-linear-regression.html#cb66-2" aria-hidden="true"></a>ans2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>anscombe<span class="op">$</span>x2, <span class="dt">y=</span>anscombe<span class="op">$</span>y2)</span>
<span id="cb66-3"><a href="simple-linear-regression.html#cb66-3" aria-hidden="true"></a>ans3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>anscombe<span class="op">$</span>x3, <span class="dt">y=</span>anscombe<span class="op">$</span>y3)</span>
<span id="cb66-4"><a href="simple-linear-regression.html#cb66-4" aria-hidden="true"></a>ans4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>anscombe<span class="op">$</span>x4, <span class="dt">y=</span>anscombe<span class="op">$</span>y4)</span>
<span id="cb66-5"><a href="simple-linear-regression.html#cb66-5" aria-hidden="true"></a><span class="kw">print</span>(ans1)</span></code></pre></div>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>Compute the mean of each <code>x</code> and <code>y</code> variable.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="simple-linear-regression.html#cb67-1" aria-hidden="true"></a><span class="kw">mean</span>(ans1<span class="op">$</span>x) <span class="co"># individual column</span></span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="simple-linear-regression.html#cb69-1" aria-hidden="true"></a><span class="kw">mean</span>(ans1<span class="op">$</span>y) <span class="co"># individual column</span></span></code></pre></div>
<pre><code>## [1] 7.5009</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="simple-linear-regression.html#cb71-1" aria-hidden="true"></a><span class="kw">sapply</span>(ans2, mean) <span class="co"># all columns in ans2</span></span></code></pre></div>
<pre><code>##      x      y 
## 9.0000 7.5009</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="simple-linear-regression.html#cb73-1" aria-hidden="true"></a><span class="kw">sapply</span>(anscombe, mean) <span class="co"># all columns in the full anscombe dataset</span></span></code></pre></div>
<pre><code>##     x1     x2     x3     x4     y1     y2     y3     y4 
## 9.0000 9.0000 9.0000 9.0000 7.5009 7.5009 7.5000 7.5009</code></pre>
<p><em>Comment: This is really interesting, all the means of <code>x</code> columns
as well as the means of <code>y</code>s are almost identical.</em></p>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>Compute the standard deviation of each <code>x</code> and <code>y</code> variable.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>The solution is similar to the previous one, just replace <code>mean</code> with <code>sd</code>.
Here, to learn something new, we will use the <code>knitr::kable()</code> function
that pretty-prints a given matrix or data frame:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="simple-linear-regression.html#cb75-1" aria-hidden="true"></a>results &lt;-<span class="st"> </span><span class="kw">sapply</span>(anscombe, sd)</span>
<span id="cb75-2"><a href="simple-linear-regression.html#cb75-2" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(results, <span class="dt">col.names=</span><span class="st">&quot;standard deviation&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">standard deviation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x1</td>
<td align="right">3.3166</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="right">3.3166</td>
</tr>
<tr class="odd">
<td align="left">x3</td>
<td align="right">3.3166</td>
</tr>
<tr class="even">
<td align="left">x4</td>
<td align="right">3.3166</td>
</tr>
<tr class="odd">
<td align="left">y1</td>
<td align="right">2.0316</td>
</tr>
<tr class="even">
<td align="left">y2</td>
<td align="right">2.0317</td>
</tr>
<tr class="odd">
<td align="left">y3</td>
<td align="right">2.0304</td>
</tr>
<tr class="even">
<td align="left">y4</td>
<td align="right">2.0306</td>
</tr>
</tbody>
</table>
<p><em>Comment: This is even more interesting, because the numbers agree up to 2 decimal digits.</em></p>
</details>
<!--
TODO: cor() covered later
Compute the Pearson linear correlation coefficient
for each of the four pairs of `x` and `y`.

To recall, this can be done with the `cor()` function.
What is the Pearson $r$ coefficient is explained in Lecture 3.


```r
cor(ans1$x, ans1$y)
```

```
## [1] 0.81642
```

```r
cor(ans2$x, ans2$y)
```

```
## [1] 0.81624
```

```r
cor(ans3$x, ans3$y)
```

```
## [1] 0.81629
```

```r
cor(ans4$x, ans4$y)
```

```
## [1] 0.81652
```


*Comment: We get a feeling that we're being tricked by Anscombe...
All the variables are highly correlated, and the correlation
coefficients are more or less the same.*
-->
<div class="exercise"><strong>Exercise.</strong>
<p>Fit a simple linear regression model for each data set.
Draw the scatter plots again (<code>plot()</code>)
and add the regression lines (<code>lines()</code> or <code>abline()</code>).</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>To recall, this can be done with the <code>lm()</code> function
explained in Lecture 2.</p>
<p>At this point we should already have become lazy – the tasks are very
repetitious. Let’s automate them by writing a single function
that does all the above for any data set:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="simple-linear-regression.html#cb76-1" aria-hidden="true"></a>fit_models &lt;-<span class="st"> </span><span class="cf">function</span>(ans) {</span>
<span id="cb76-2"><a href="simple-linear-regression.html#cb76-2" aria-hidden="true"></a>    <span class="co"># ans is a data frame with columns x and y</span></span>
<span id="cb76-3"><a href="simple-linear-regression.html#cb76-3" aria-hidden="true"></a>    f &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x, <span class="dt">data=</span>ans) <span class="co"># fit linear model</span></span>
<span id="cb76-4"><a href="simple-linear-regression.html#cb76-4" aria-hidden="true"></a>    <span class="kw">print</span>(f<span class="op">$</span>coefficients) <span class="co"># estimated coefficients</span></span>
<span id="cb76-5"><a href="simple-linear-regression.html#cb76-5" aria-hidden="true"></a>    <span class="kw">plot</span>(ans<span class="op">$</span>x, ans<span class="op">$</span>y) <span class="co"># scatter plot</span></span>
<span id="cb76-6"><a href="simple-linear-regression.html#cb76-6" aria-hidden="true"></a>    <span class="kw">abline</span>(f, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># regression line</span></span>
<span id="cb76-7"><a href="simple-linear-regression.html#cb76-7" aria-hidden="true"></a>    <span class="kw">return</span>(f)</span>
<span id="cb76-8"><a href="simple-linear-regression.html#cb76-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now we can apply it on the four particular examples.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="simple-linear-regression.html#cb77-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># four plots on 1 figure (2x2 grid)</span></span>
<span id="cb77-2"><a href="simple-linear-regression.html#cb77-2" aria-hidden="true"></a>f1 &lt;-<span class="st"> </span><span class="kw">fit_models</span>(ans1)</span></code></pre></div>
<pre><code>## (Intercept)           x 
##     3.00009     0.50009</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="simple-linear-regression.html#cb79-1" aria-hidden="true"></a>f2 &lt;-<span class="st"> </span><span class="kw">fit_models</span>(ans2)</span></code></pre></div>
<pre><code>## (Intercept)           x 
##      3.0009      0.5000</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="simple-linear-regression.html#cb81-1" aria-hidden="true"></a>f3 &lt;-<span class="st"> </span><span class="kw">fit_models</span>(ans3)</span></code></pre></div>
<pre><code>## (Intercept)           x 
##     3.00245     0.49973</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="simple-linear-regression.html#cb83-1" aria-hidden="true"></a>f4 &lt;-<span class="st"> </span><span class="kw">fit_models</span>(ans4)</span></code></pre></div>
<pre><code>## (Intercept)           x 
##     3.00173     0.49991</code></pre>
<div class="figure"><span id="fig:anscombe-fit-apply"></span>
<img src="01-regression-simple-figures/anscombe-fit-apply-1.png" alt="" />
<p class="caption">Figure 1.11:  Fitted regression lines for the Anscombe quartet</p>
</div>
<p><em>Comment: All the estimated models are virtually the same,
the regression lines are
<span class="math inline">\(y=0.5x+3\)</span>, compare Figure <a href="simple-linear-regression.html#fig:anscombe-fit-apply">1.11</a>.</em></p>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>Create scatter plots of the residuals (predicted <span class="math inline">\(\hat{y}_i\)</span> minus
true <span class="math inline">\(y_i\)</span>) as a function of the predicted <span class="math inline">\(\hat{y}_i=f(x_i)\)</span> for every
<span class="math inline">\(i=1,\dots,11\)</span>.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>To recall, the model predictions can be generated by (amongst others)
calling the <code>predict()</code> function.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="simple-linear-regression.html#cb85-1" aria-hidden="true"></a>y_pred1 &lt;-<span class="st"> </span>f1<span class="op">$</span>fitted.values <span class="co"># predict(f1, ans1)</span></span>
<span id="cb85-2"><a href="simple-linear-regression.html#cb85-2" aria-hidden="true"></a>y_pred2 &lt;-<span class="st"> </span>f2<span class="op">$</span>fitted.values <span class="co"># predict(f2, ans2)</span></span>
<span id="cb85-3"><a href="simple-linear-regression.html#cb85-3" aria-hidden="true"></a>y_pred3 &lt;-<span class="st"> </span>f3<span class="op">$</span>fitted.values <span class="co"># predict(f3, ans3)</span></span>
<span id="cb85-4"><a href="simple-linear-regression.html#cb85-4" aria-hidden="true"></a>y_pred4 &lt;-<span class="st"> </span>f4<span class="op">$</span>fitted.values <span class="co"># predict(f4, ans4)</span></span></code></pre></div>
<p>Plots of residuals as a function of the predicted (fitted) values
are given in Figure <a href="simple-linear-regression.html#fig:anscombe-resid-plot">1.12</a>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="simple-linear-regression.html#cb86-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># four plots on 1 figure (2x2 grid)</span></span>
<span id="cb86-2"><a href="simple-linear-regression.html#cb86-2" aria-hidden="true"></a><span class="kw">plot</span>(y_pred1, y_pred1<span class="op">-</span>ans1<span class="op">$</span>y)</span>
<span id="cb86-3"><a href="simple-linear-regression.html#cb86-3" aria-hidden="true"></a><span class="kw">plot</span>(y_pred2, y_pred2<span class="op">-</span>ans2<span class="op">$</span>y)</span>
<span id="cb86-4"><a href="simple-linear-regression.html#cb86-4" aria-hidden="true"></a><span class="kw">plot</span>(y_pred3, y_pred3<span class="op">-</span>ans3<span class="op">$</span>y)</span>
<span id="cb86-5"><a href="simple-linear-regression.html#cb86-5" aria-hidden="true"></a><span class="kw">plot</span>(y_pred4, y_pred4<span class="op">-</span>ans4<span class="op">$</span>y)</span></code></pre></div>
<div class="figure"><span id="fig:anscombe-resid-plot"></span>
<img src="01-regression-simple-figures/anscombe-resid-plot-1.png" alt="" />
<p class="caption">Figure 1.12:  Residuals vs. fitted values for the regression lines fitted to the Anscombe quartet</p>
</div>
<p><em>Comment: Ideally, the residuals shouldn’t be correlated
with the predicted values – they should “oscillate” randomly
around 0. This is only the case of the first dataset.
All the other cases are “alarming” in the sense that
they suggest that the obtained models are “suspicious”
(perhaps data cleansing is needed or a linear model is not at all appropriate).</em></p>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>Draw conclusions (in your own words).</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>We’re being taught a lesson here: don’t perform data analysis tasks
automatically, don’t look at bare numbers only, visualise your data first!</p>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>Read more about Anscombe’s quartet at <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet" class="uri">https://en.wikipedia.org/wiki/Anscombe%27s_quartet</a></p>
</div>
</div>
</div>
<div id="outro" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Outro</h2>
<div id="remarks" class="section level3" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Remarks</h3>
<p>In supervised learning, with each input point,
there’s an associated reference output value.</p>
<p>Learning a model = constructing a function that approximates
(minimising some error measure) the given data.</p>
<p>Regression = the output variable <span class="math inline">\(Y\)</span> is continuous.</p>
<p>We studied linear models with a single independent variable based on
the least squares (SSR) fit.</p>
<p>In the next part we will extend this setting to the case
of many variables, i.e., <span class="math inline">\(p&gt;1\)</span>, called multiple regression.</p>
</div>
<div id="further-reading" class="section level3" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> Further Reading</h3>
<p>Recommended further reading: <span class="citation">(James et al. <a href="#ref-islr" role="doc-biblioref">2017</a>: Chapters 1, 2 and 3)</span></p>
<p>Other: <span class="citation">(Hastie et al. <a href="#ref-esl" role="doc-biblioref">2017</a>: Chapter 1, Sections 3.2 and 3.3)</span></p>

<!--
kate: indent-width 4; word-wrap-column 74; default-dictionary en_AU
Copyright (C) 2020-2021, Marek Gagolewski <https://www.gagolewski.com>
This material is licensed under the Creative Commons BY-NC-ND 4.0 License.
-->
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-esl">
<p>Hastie T, Tibshirani R, Friedman J (2017) <em>The elements of statistical learning</em>. Springer-Verlag <a href="https://web.stanford.edu/~hastie/ElemStatLearn/">https://web.stanford.edu/~hastie/ElemStatLearn/</a>.</p>
</div>
<div id="ref-islr">
<p>James G, Witten D, Hastie T, Tibshirani R (2017) <em>An introduction to statistical learning with applications in R</em>. Springer-Verlag <a href="https://www.statlearning.com/">https://www.statlearning.com/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": "lmlcr.pdf",
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
